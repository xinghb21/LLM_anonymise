/*! For license information please see script.bundle.js.LICENSE.txt */
(()=>{var e={954:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(76),r=n(635),i=n(742),s=n(770),a=n(859);const c=n(417).createClientLogger("openai"),l={"POST /deployments/{deploymentId}/audio/transcriptions":["200"],"POST /deployments/{deploymentId}/audio/translations":["200"],"POST /deployments/{deploymentId}/completions":["200"],"POST /deployments/{deploymentId}/chat/completions":["200"],"POST /deployments/{deploymentId}/images/generations":["200"],"POST /deployments/{deploymentId}/embeddings":["200"],"GET /operations/images/{operationId}":["200"],"POST /images/generations:submit":["202"],"GET /images/generations:submit":["200","202"]};function u(e){const t=e.headers["x-ms-original-url"],n=new URL(null!=t?t:e.request.url),o=e.request.method;let r=l[`${o} ${n.pathname}`];return r||(r=function(e,t){var n,o,r,i;const s=t.split("/");let a=-1,c=[];for(const[t,u]of Object.entries(l)){if(!t.startsWith(e))continue;const l=d(t),p=l.split("/");let f=!0;for(let e=p.length-1,t=s.length-1;e>=1&&t>=1;e--,t--)if((null===(n=p[e])||void 0===n?void 0:n.startsWith("{"))&&-1!==(null===(o=p[e])||void 0===o?void 0:o.indexOf("}"))){const n=p[e].indexOf("}")+1,o=null===(r=p[e])||void 0===r?void 0:r.length;if(!new RegExp(`${null===(i=p[e])||void 0===i?void 0:i.slice(n,o)}`).test(s[t]||"")){f=!1;break}}else if(p[e]!==s[t]){f=!1;break}f&&l.length>a&&(a=l.length,c=u)}return c}(o,n.pathname)),!r.includes(e.status)}function d(e){const t=e.indexOf("/");return e.slice(t)}function p(e,t){try{return e()}catch(e){throw new Error(`${t}: ${e}`,{cause:e})}}function f(e){if("object"!=typeof e||!e)return e;if(Array.isArray(e))return e.map((e=>f(e)));for(const t of Object.keys(e)){const n=e[t],o=t.toLowerCase().replace(/([_][a-z])/g,(e=>e.toUpperCase().replace("_","")));o!==t&&delete e[t],e[o]="object"==typeof e[o]?f(n):n}return e}function y(e){if("object"!=typeof e||!e)return e;if(Array.isArray(e))return e.map((e=>y(e)));for(const t of Object.keys(e)){const n=e[t],o=t.replace(/([A-Z])/g,(e=>`_${e.toLowerCase()}`)).replace(/^_/,"");o!==t&&delete e[t],e[o]="object"==typeof e[o]?y(n):n}return e}function h(e){return"image_url"===e.type?function(e){return{type:e.type,image_url:{url:e.imageUrl.url,detail:e.imageUrl.detail}}}(e):e}function m(e){switch(e.type){case"connection_string":return function(e){return{type:e.type,connection_string:e.connectionString}}(e);case"key_and_key_id":return function(e){return{type:e.type,key:e.key,key_id:e.keyId}}(e);case"encoded_api_key":return function(e){return{type:e.type,encoded_api_key:e.encodedApiKey}}(e);case"access_token":return function(e){return{type:e.type,access_token:e.accessToken}}(e);case"user_assigned_managed_identity":return function(e){return{type:e.type,managed_identity_resource_id:e.managedIdentityResourceId}}(e);default:return e}}function g(e){switch(e.type){case"endpoint":return function(e){return{type:e.type,endpoint:e.endpoint,authentication:m(e.authentication)}}(e);case"deployment_name":return function(e){return{type:e.type,deployment_name:e.deploymentName}}(e);case"model_id":return function(e){return{type:e.type,model_id:e.modelId}}(e);default:return e}}function v(e){return r.__asyncGenerator(this,arguments,(function*(){const t=e.getReader();try{for(;;){const{value:e,done:n}=yield r.__await(t.read());if(n)return yield r.__await(void 0);yield yield r.__await(e)}}finally{const e=t.cancel();t.releaseLock(),yield r.__await(e)}}))}async function b(e,t){const n=await async function(e){const{body:t,status:n}=await e.asNodeStream();if("200"!==n&&void 0!==t){const e=await(o=t,new Promise(((e,t)=>{const n=[];o.on("data",(e=>{Buffer.isBuffer(e)?n.push(e):n.push(Buffer.from(e))})),o.on("end",(()=>{e(Buffer.concat(n).toString("utf8"))})),o.on("error",(e=>{e&&"AbortError"===(null==e?void 0:e.name)?t(e):t(new s.RestError(`Error reading response as text: ${e.message}`,{code:s.RestError.PARSE_ERROR}))}))})));throw p((()=>JSON.parse(e).error),"Error parsing response body")}var o;if(!t)throw new Error("No stream found in response. Did you enable the stream option?");return t}(e),o=a.createSseStream(n),r=new TransformStream({transform:async(e,n)=>{"[DONE]"!==e.data&&n.enqueue(t(p((()=>JSON.parse(e.data)),"Error parsing an event. See 'cause' for more details")))}});return i=o.pipeThrough(r),(c=i)[Symbol.asyncIterator]||(c[Symbol.asyncIterator]=()=>v(c)),c.values||(c.values=()=>v(c)),i;var i,c}async function w(e,t,n,o,a){const c=null!=a?a:"string"==typeof o?{}:null!=o?o:{},l="string"==typeof o?o:void 0,{abortSignal:u,onResponse:d,requestOptions:p,tracingOptions:h}=c,m=r.__rest(c,["abortSignal","onResponse","requestOptions","tracingOptions"]),{body:g,status:v}=await e.pathUnchecked("deployments/{deploymentName}/audio/transcriptions",t).post(Object.assign(Object.assign({},i.operationOptionsToRequestParameters({abortSignal:u,onResponse:d,tracingOptions:h,requestOptions:p})),{contentType:"multipart/form-data",body:Object.assign(Object.assign(Object.assign({},y(m)),{file:s.createFile(n,"placeholder.wav")}),l?{response_format:l}:{})}));if("200"!==v)throw g.error;return"verbose_json"!==l?g:f(g)}async function _(e,t,n,o,a){const c=null!=a?a:"string"==typeof o?{}:null!=o?o:{},l="string"==typeof o?o:void 0,{abortSignal:u,onResponse:d,requestOptions:p,tracingOptions:h}=c,m=r.__rest(c,["abortSignal","onResponse","requestOptions","tracingOptions"]),{body:g,status:v}=await e.pathUnchecked("deployments/{deploymentName}/audio/translations",t).post(Object.assign(Object.assign({},i.operationOptionsToRequestParameters({abortSignal:u,onResponse:d,tracingOptions:h,requestOptions:p})),{contentType:"multipart/form-data",body:Object.assign(Object.assign(Object.assign({},y(m)),{file:s.createFile(n,"placeholder.wav")}),l?{response_format:l}:{})}));if("200"!==v)throw g.error;return"verbose_json"!==l?g:f(g)}function x(e,t,n,o={requestOptions:{}}){return e.path("/deployments/{deploymentId}/completions",t).post(Object.assign(Object.assign({},i.operationOptionsToRequestParameters(o)),{body:{prompt:n.prompt,max_tokens:n.maxTokens,temperature:n.temperature,top_p:n.topP,logit_bias:n.logitBias,user:n.user,n:n.n,logprobs:n.logprobs,suffix:n.suffix,echo:n.echo,stop:n.stop,presence_penalty:n.presencePenalty,frequency_penalty:n.frequencyPenalty,best_of:n.bestOf,stream:n.stream,model:n.model}}))}function S(e){const{created:t,choices:n,prompt_filter_results:o,prompt_annotations:i}=e,s=r.__rest(e,["created","choices","prompt_filter_results","prompt_annotations"]);return Object.assign(Object.assign(Object.assign(Object.assign({},f(s)),{created:new Date(t)}),{promptFilterResults:R({prompt_filter_results:o,prompt_annotations:i})}),{choices:n.map((e=>{var{content_filter_results:t}=e,n=r.__rest(e,["content_filter_results"]);return Object.assign(Object.assign({},f(n)),t?{contentFilterResults:C(t)}:{})}))})}function O(e){const{created:t,choices:n,prompt_filter_results:o,prompt_annotations:i,usage:s}=e,a=r.__rest(e,["created","choices","prompt_filter_results","prompt_annotations","usage"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},f(a)),{created:new Date(t)}),{promptFilterResults:R({prompt_filter_results:o,prompt_annotations:i})}),s?{usage:{completionTokens:s.completion_tokens,promptTokens:s.prompt_tokens,totalTokens:s.total_tokens}}:{}),{choices:n?n.map((e=>{var{content_filter_results:t}=e,n=r.__rest(e,["content_filter_results"]);return Object.assign(Object.assign({},f(n)),t?{contentFilterResults:C(t)}:{})})):[]})}function P(e,t,n,o={requestOptions:{}}){const{azureExtensionOptions:s,abortSignal:a,onResponse:c,requestOptions:l,tracingOptions:u}=o,d=r.__rest(o,["azureExtensionOptions","abortSignal","onResponse","requestOptions","tracingOptions"]),p={abortSignal:a,onResponse:c,requestOptions:l,tracingOptions:u},f=Object.assign(Object.assign({},(null==s?void 0:s.extensions)?{dataSources:s.extensions}:{}),(null==s?void 0:s.enhancements)?{enhancements:s.enhancements}:{});return function(e,t,n,o={requestOptions:{}}){var s,a,c,l,u,d,p;return e.path("/deployments/{deploymentId}/chat/completions",t).post(Object.assign(Object.assign({},i.operationOptionsToRequestParameters(o)),{body:{model:n.model,stream:n.stream,max_tokens:n.maxTokens,temperature:n.temperature,top_p:n.topP,logit_bias:n.logitBias,user:n.user,n:n.n,stop:n.stop,presence_penalty:n.presencePenalty,frequency_penalty:n.frequencyPenalty,data_sources:void 0===n.dataSources?n.dataSources:n.dataSources.map((e=>function(e){switch(e.type){case"azure_search":return function(e){var t,n,o,r,i,s,a;return{type:e.type,parameters:{authentication:e.authentication?m(e.authentication):e.authentication,top_n_documents:e.topNDocuments,in_scope:e.inScope,strictness:e.strictness,role_information:e.roleInformation,endpoint:e.endpoint,index_name:e.indexName,fields_mapping:e.fieldsMapping?{title_field:null===(t=e.fieldsMapping)||void 0===t?void 0:t.titleField,url_field:null===(n=e.fieldsMapping)||void 0===n?void 0:n.urlField,filepath_field:null===(o=e.fieldsMapping)||void 0===o?void 0:o.filepathField,content_fields:null===(r=e.fieldsMapping)||void 0===r?void 0:r.contentFields,content_fields_separator:null===(i=e.fieldsMapping)||void 0===i?void 0:i.contentFieldsSeparator,vector_fields:null===(s=e.fieldsMapping)||void 0===s?void 0:s.vectorFields,image_vector_fields:null===(a=e.fieldsMapping)||void 0===a?void 0:a.imageVectorFields}:void 0,query_type:e.queryType,semantic_configuration:e.semanticConfiguration,filter:e.filter,embedding_dependency:e.embeddingDependency?g(e.embeddingDependency):e.embeddingDependency}}}(e);case"azure_ml_index":return function(e){return{type:e.type,parameters:{authentication:e.authentication?m(e.authentication):e.authentication,top_n_documents:e.topNDocuments,in_scope:e.inScope,strictness:e.strictness,role_information:e.roleInformation,project_resource_id:e.projectResourceId,name:e.name,version:e.version,filter:e.filter}}}(e);case"azure_cosmos_db":return function(e){return{type:e.type,parameters:{authentication:e.authentication?m(e.authentication):e.authentication,top_n_documents:e.topNDocuments,in_scope:e.inScope,strictness:e.strictness,role_information:e.roleInformation,database_name:e.databaseName,container_name:e.containerName,index_name:e.indexName,fields_mapping:{title_field:e.fieldsMapping.titleField,url_field:e.fieldsMapping.urlField,filepath_field:e.fieldsMapping.filepathField,content_fields:e.fieldsMapping.contentFields,content_fields_separator:e.fieldsMapping.contentFieldsSeparator,vector_fields:e.fieldsMapping.vectorFields},embedding_dependency:g(e.embeddingDependency)}}}(e);case"elasticsearch":return function(e){var t,n,o,r,i,s;return{type:e.type,parameters:{authentication:e.authentication?m(e.authentication):e.authentication,top_n_documents:e.topNDocuments,in_scope:e.inScope,strictness:e.strictness,role_information:e.roleInformation,endpoint:e.endpoint,index_name:e.indexName,fields_mapping:e.fieldsMapping?{title_field:null===(t=e.fieldsMapping)||void 0===t?void 0:t.titleField,url_field:null===(n=e.fieldsMapping)||void 0===n?void 0:n.urlField,filepath_field:null===(o=e.fieldsMapping)||void 0===o?void 0:o.filepathField,content_fields:null===(r=e.fieldsMapping)||void 0===r?void 0:r.contentFields,content_fields_separator:null===(i=e.fieldsMapping)||void 0===i?void 0:i.contentFieldsSeparator,vector_fields:null===(s=e.fieldsMapping)||void 0===s?void 0:s.vectorFields}:void 0,query_type:e.queryType,embedding_dependency:e.embeddingDependency?g(e.embeddingDependency):e.embeddingDependency}}}(e);case"pinecone":return function(e){return{type:e.type,parameters:{authentication:e.authentication?m(e.authentication):e.authentication,top_n_documents:e.topNDocuments,in_scope:e.inScope,strictness:e.strictness,role_information:e.roleInformation,environment:e.environment,index_name:e.indexName,fields_mapping:{title_field:e.fieldsMapping.titleField,url_field:e.fieldsMapping.urlField,filepath_field:e.fieldsMapping.filepathField,content_fields:e.fieldsMapping.contentFields,content_fields_separator:e.fieldsMapping.contentFieldsSeparator},embedding_dependency:g(e.embeddingDependency)}}}(e);default:return e}}(e))),enhancements:n.enhancements?{grounding:(null===(s=n.enhancements)||void 0===s?void 0:s.grounding)?{enabled:null===(c=null===(a=n.enhancements)||void 0===a?void 0:a.grounding)||void 0===c?void 0:c.enabled}:void 0,ocr:(null===(l=n.enhancements)||void 0===l?void 0:l.ocr)?{enabled:null===(d=null===(u=n.enhancements)||void 0===u?void 0:u.ocr)||void 0===d?void 0:d.enabled}:void 0}:void 0,seed:n.seed,logprobs:n.logprobs,top_logprobs:n.topLogprobs,response_format:n.responseFormat?{type:null===(p=n.responseFormat)||void 0===p?void 0:p.type}:void 0,tool_choice:n.toolChoice,tools:n.tools,functions:void 0===n.functions?n.functions:n.functions.map((e=>({name:e.name,description:e.description,parameters:e.parameters}))),function_call:n.functionCall,messages:n.messages.map((e=>function(e){switch(e.role){case"user":return function(e){return{role:e.role,content:"string"==typeof e.content?e.content:e.content.map(h),name:e.name}}(e);case"assistant":return function(e){void 0===e.content&&(e.content=null);const{functionCall:t,toolCalls:n}=e,o=r.__rest(e,["functionCall","toolCalls"]);return Object.assign(Object.assign(Object.assign({},y(o)),n&&0!==n.length?{tool_calls:n}:{}),t?{function_call:t}:{})}(e);case"tool":return function(e){return{role:e.role,content:e.content,tool_call_id:e.toolCallId}}(e);default:return e}}(e)))}}))}(e,t,Object.assign(Object.assign({messages:n},d),f),p)}function R({prompt_annotations:e,prompt_filter_results:t}){const n=null!=t?t:e;return null==n?void 0:n.map((e=>{var{content_filter_results:t}=e,n=r.__rest(e,["content_filter_results"]);return Object.assign(Object.assign({},f(n)),{contentFilterResults:E(t)})}))}function E(e={}){var{error:t}=e,n=r.__rest(e,["error"]);return t?function(e){var t;return{error:Object.assign(Object.assign({},e),{details:null!==(t=e.details)&&void 0!==t?t:[]})}}(t):f(n)}function C(e={}){var t,{error:n}=e,o=r.__rest(e,["error"]);return n?{error:Object.assign(Object.assign({},n),{details:null!==(t=n.details)&&void 0!==t?t:[]})}:f(o)}function k(e){return e.startsWith("Bearer ")?e:`Bearer ${e}`}Object.defineProperty(t,"AzureKeyCredential",{enumerable:!0,get:function(){return o.AzureKeyCredential}}),t.OpenAIClient=class{constructor(e,t={},n={}){var s,a;let l,u,d;if(this._isAzure=!1,function(e){return o.isTokenCredential(e)||void 0!==e.key}(t))u=e,d=t,l=n,this._isAzure=!0;else{u="https://api.openai.com/v1",d=e;const{credentials:n}=t,o=r.__rest(t,["credentials"]);l=Object.assign({credentials:{apiKeyHeaderName:null!==(s=null==n?void 0:n.apiKeyHeaderName)&&void 0!==s?s:"Authorization",scopes:null==n?void 0:n.scopes}},o)}this._client=function(e,t,n={}){const o=function(e,t,n={}){var o,r,s,a,l,u,d,p;const f=null!==(o=n.baseUrl)&&void 0!==o?o:`${e}/openai`;n.apiVersion=null!==(r=n.apiVersion)&&void 0!==r?r:"2024-03-01-preview";const y="azsdk-js-openai-rest/1.0.0-beta.12",h=n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${y}`:`${y}`;return n=Object.assign(Object.assign({},n),{userAgentOptions:{userAgentPrefix:h},loggingOptions:{logger:null!==(a=null===(s=n.loggingOptions)||void 0===s?void 0:s.logger)&&void 0!==a?a:c.info},credentials:{scopes:null!==(u=null===(l=n.credentials)||void 0===l?void 0:l.scopes)&&void 0!==u?u:["https://cognitiveservices.azure.com/.default"],apiKeyHeaderName:null!==(p=null===(d=n.credentials)||void 0===d?void 0:d.apiKeyHeaderName)&&void 0!==p?p:"api-key"}}),i.getClient(f,t,n)}(e,t,n);return o}(u,d,Object.assign(Object.assign({},l),this._isAzure?{}:{additionalPolicies:[...null!==(a=l.additionalPolicies)&&void 0!==a?a:[],{position:"perCall",policy:{name:"openAiEndpoint",sendRequest:(e,t)=>{const n=new URL(e.url),o=n.pathname.split("/");switch(o[o.length-1]){case"completions":"chat"===o[o.length-2]?n.pathname=`${o[1]}/chat/completions`:n.pathname=`${o[1]}/completions`;break;case"embeddings":n.pathname=`${o[1]}/embeddings`;break;case"generations":if("images"!==o[o.length-2])throw new Error("Unexpected path");n.pathname=`${o[1]}/images/generations`;break;case"transcriptions":n.pathname=`${o[1]}/audio/transcriptions`;break;case"translations":n.pathname=`${o[1]}/audio/translations`}return n.searchParams.delete("api-version"),e.url=n.toString(),t(e)}}}]}))}setModel(e,t){this._isAzure||(t.model=e)}async getAudioTranslation(e,t,n,o){const r=null!=o?o:"string"==typeof n?{}:null!=n?n:{},i="string"==typeof n?n:void 0;return this.setModel(e,r),void 0===i?_(this._client,e,t,r):_(this._client,e,t,i,r)}async getAudioTranscription(e,t,n,o){const r=null!=o?o:"string"==typeof n?{}:null!=n?n:{},i="string"==typeof n?n:void 0;return this.setModel(e,r),void 0===i?w(this._client,e,t,r):w(this._client,e,t,i,r)}getCompletions(e,t,n={requestOptions:{}}){this.setModel(e,n);const{abortSignal:o,onResponse:i,requestOptions:s,tracingOptions:a}=n,c=r.__rest(n,["abortSignal","onResponse","requestOptions","tracingOptions"]);return async function(e,t,n,o={requestOptions:{}}){return async function(e){if(u(e))throw e.body.error;return S(e.body)}(await x(e,t,n,o))}(this._client,e,Object.assign({prompt:t},c),{abortSignal:o,onResponse:i,requestOptions:s,tracingOptions:a})}streamCompletions(e,t,n={}){return this.setModel(e,n),function(e,t,n,o={requestOptions:{}}){const{abortSignal:i,onResponse:s,requestOptions:a,tracingOptions:c}=o,l=r.__rest(o,["abortSignal","onResponse","requestOptions","tracingOptions"]);return b(x(e,t,Object.assign(Object.assign({prompt:n},l),{stream:!0}),{abortSignal:i,onResponse:s,requestOptions:a,tracingOptions:c}),S)}(this._client,e,t,n)}getChatCompletions(e,t,n={requestOptions:{}}){return this.setModel(e,n),async function(e,t,n,o={requestOptions:{}}){return async function(e){if(u(e))throw e.body.error;return O(e.body)}(await P(e,t,n,o))}(this._client,e,t,n)}streamChatCompletions(e,t,n={requestOptions:{}}){return this.setModel(e,n),function(e,t,n,o={requestOptions:{}}){return b(P(e,t,n,Object.assign(Object.assign({},o),{stream:!0})),O)}(this._client,e,t,n)}getImages(e,t,n={requestOptions:{}}){this.setModel(e,n);const{abortSignal:o,onResponse:s,requestOptions:a,tracingOptions:c}=n,l=r.__rest(n,["abortSignal","onResponse","requestOptions","tracingOptions"]);return async function(e,t,n,o={requestOptions:{}}){const r=await function(e,t,n,o={requestOptions:{}}){return e.path("/deployments/{deploymentId}/images/generations",t).post(Object.assign(Object.assign({},i.operationOptionsToRequestParameters(o)),{body:{model:n.model,prompt:n.prompt,n:n.n,size:n.size,response_format:n.responseFormat,quality:n.quality,style:n.style,user:n.user}}))}(e,t,n,o);return async function(e){if(u(e))throw e.body.error;return{created:new Date(e.body.created),data:e.body.data.map((e=>{var t,n,o,r,i,s,a,c,l,u,d,p,f,y,h,m,g,v,b,w,_,x,S,O,P,R,E,C,k,A,q,j,T,I,M,B,D,N,L,$,H,U,F,z,J,W,V,G,K,Q;return{url:e.url,base64Data:e.b64_json,contentFilterResults:e.content_filter_results?{sexual:(null===(t=e.content_filter_results)||void 0===t?void 0:t.sexual)?{severity:null===(o=null===(n=e.content_filter_results)||void 0===n?void 0:n.sexual)||void 0===o?void 0:o.severity,filtered:null===(i=null===(r=e.content_filter_results)||void 0===r?void 0:r.sexual)||void 0===i?void 0:i.filtered}:void 0,violence:(null===(s=e.content_filter_results)||void 0===s?void 0:s.violence)?{severity:null===(c=null===(a=e.content_filter_results)||void 0===a?void 0:a.violence)||void 0===c?void 0:c.severity,filtered:null===(u=null===(l=e.content_filter_results)||void 0===l?void 0:l.violence)||void 0===u?void 0:u.filtered}:void 0,hate:(null===(d=e.content_filter_results)||void 0===d?void 0:d.hate)?{severity:null===(f=null===(p=e.content_filter_results)||void 0===p?void 0:p.hate)||void 0===f?void 0:f.severity,filtered:null===(h=null===(y=e.content_filter_results)||void 0===y?void 0:y.hate)||void 0===h?void 0:h.filtered}:void 0,selfHarm:(null===(m=e.content_filter_results)||void 0===m?void 0:m.self_harm)?{severity:null===(v=null===(g=e.content_filter_results)||void 0===g?void 0:g.self_harm)||void 0===v?void 0:v.severity,filtered:null===(w=null===(b=e.content_filter_results)||void 0===b?void 0:b.self_harm)||void 0===w?void 0:w.filtered}:void 0}:void 0,revisedPrompt:e.revised_prompt,promptFilterResults:e.prompt_filter_results?{sexual:(null===(_=e.prompt_filter_results)||void 0===_?void 0:_.sexual)?{severity:null===(S=null===(x=e.prompt_filter_results)||void 0===x?void 0:x.sexual)||void 0===S?void 0:S.severity,filtered:null===(P=null===(O=e.prompt_filter_results)||void 0===O?void 0:O.sexual)||void 0===P?void 0:P.filtered}:void 0,violence:(null===(R=e.prompt_filter_results)||void 0===R?void 0:R.violence)?{severity:null===(C=null===(E=e.prompt_filter_results)||void 0===E?void 0:E.violence)||void 0===C?void 0:C.severity,filtered:null===(A=null===(k=e.prompt_filter_results)||void 0===k?void 0:k.violence)||void 0===A?void 0:A.filtered}:void 0,hate:(null===(q=e.prompt_filter_results)||void 0===q?void 0:q.hate)?{severity:null===(T=null===(j=e.prompt_filter_results)||void 0===j?void 0:j.hate)||void 0===T?void 0:T.severity,filtered:null===(M=null===(I=e.prompt_filter_results)||void 0===I?void 0:I.hate)||void 0===M?void 0:M.filtered}:void 0,selfHarm:(null===(B=e.prompt_filter_results)||void 0===B?void 0:B.self_harm)?{severity:null===(N=null===(D=e.prompt_filter_results)||void 0===D?void 0:D.self_harm)||void 0===N?void 0:N.severity,filtered:null===($=null===(L=e.prompt_filter_results)||void 0===L?void 0:L.self_harm)||void 0===$?void 0:$.filtered}:void 0,profanity:(null===(H=e.prompt_filter_results)||void 0===H?void 0:H.profanity)?{filtered:null===(F=null===(U=e.prompt_filter_results)||void 0===U?void 0:U.profanity)||void 0===F?void 0:F.filtered,detected:null===(J=null===(z=e.prompt_filter_results)||void 0===z?void 0:z.profanity)||void 0===J?void 0:J.detected}:void 0,jailbreak:(null===(W=e.prompt_filter_results)||void 0===W?void 0:W.jailbreak)?{filtered:null===(G=null===(V=e.prompt_filter_results)||void 0===V?void 0:V.jailbreak)||void 0===G?void 0:G.filtered,detected:null===(Q=null===(K=e.prompt_filter_results)||void 0===K?void 0:K.jailbreak)||void 0===Q?void 0:Q.detected}:void 0}:void 0}}))}}(r)}(this._client,e,Object.assign({prompt:t},l),{abortSignal:o,onResponse:s,requestOptions:a,tracingOptions:c})}getEmbeddings(e,t,n={requestOptions:{}}){this.setModel(e,n);const{abortSignal:o,onResponse:s,requestOptions:a,tracingOptions:c}=n,l=r.__rest(n,["abortSignal","onResponse","requestOptions","tracingOptions"]);return async function(e,t,n,o={requestOptions:{}}){const r=await function(e,t,n,o={requestOptions:{}}){return e.path("/deployments/{deploymentId}/embeddings",t).post(Object.assign(Object.assign({},i.operationOptionsToRequestParameters(o)),{body:{user:n.user,model:n.model,input:n.input,dimensions:n.dimensions}}))}(e,t,n,o);return async function(e){if(u(e))throw e.body.error;return{data:e.body.data.map((e=>({embedding:e.embedding,index:e.index}))),usage:{promptTokens:e.body.usage.prompt_tokens,totalTokens:e.body.usage.total_tokens}}}(r)}(this._client,e,Object.assign({input:t},l),{abortSignal:o,onResponse:s,requestOptions:a,tracingOptions:c})}},t.OpenAIKeyCredential=class{constructor(e){if(!e)throw new Error("key must be a non-empty string");this._key=k(e)}get key(){return this._key}update(e){this._key=k(e)}}},742:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addCredentialPipelinePolicy:()=>d,createRestError:()=>r,getClient:()=>v,operationOptionsToRequestParameters:()=>p});var o=n(770);function r(e,t){var n;const r="string"==typeof e?t:e,a=r.body.error||r.body,c="string"==typeof e?e:null!==(n=a.message)&&void 0!==n?n:`Unexpected status code: ${r.status}`;return new o.RestError(c,{statusCode:s(r.status),code:a.code,request:r.request,response:i(r)})}function i(e){var t;return{headers:(0,o.createHttpHeaders)(e.headers),request:e.request,status:null!==(t=s(e.status))&&void 0!==t?t:-1}}function s(e){const t=Number.parseInt(e);return Number.isNaN(t)?void 0:t}var a=n(76);const c="ApiVersionPolicy",l="keyCredentialAuthenticationPolicy";let u;function d(e,t,n={}){var r,i,s,c;const{credential:u,clientOptions:d}=n;if(u)if((0,a.isTokenCredential)(u)){const n=(0,o.bearerTokenAuthenticationPolicy)({credential:u,scopes:null!==(i=null===(r=null==d?void 0:d.credentials)||void 0===r?void 0:r.scopes)&&void 0!==i?i:`${t}/.default`});e.addPolicy(n)}else if(function(e){return void 0!==e.key}(u)){if(!(null===(s=null==d?void 0:d.credentials)||void 0===s?void 0:s.apiKeyHeaderName))throw new Error("Missing API Key Header Name");const t=function(e,t){return{name:l,sendRequest:async(n,o)=>(n.headers.set(t,e.key),o(n))}}(u,null===(c=null==d?void 0:d.credentials)||void 0===c?void 0:c.apiKeyHeaderName);e.addPolicy(t)}}function p(e){var t,n,o,r,i,s;return{allowInsecureConnection:null===(t=e.requestOptions)||void 0===t?void 0:t.allowInsecureConnection,timeout:null===(n=e.requestOptions)||void 0===n?void 0:n.timeout,skipUrlEncoding:null===(o=e.requestOptions)||void 0===o?void 0:o.skipUrlEncoding,abortSignal:e.abortSignal,onUploadProgress:null===(r=e.requestOptions)||void 0===r?void 0:r.onUploadProgress,onDownloadProgress:null===(i=e.requestOptions)||void 0===i?void 0:i.onDownloadProgress,tracingOptions:e.tracingOptions,headers:Object.assign({},null===(s=e.requestOptions)||void 0===s?void 0:s.headers),onResponse:e.onResponse}}async function f(e,t,n,r={},i){var s;const a=null!=i?i:(u||(u=(0,o.createDefaultHttpClient)()),u),c=function(e,t,n={}){var r,i,s;const a=function(e={}){var t,n,o;return null!==(o=null!==(t=e.contentType)&&void 0!==t?t:null===(n=e.headers)||void 0===n?void 0:n["content-type"])&&void 0!==o?o:function(e){if(ArrayBuffer.isView(e))return"application/octet-stream";if("string"==typeof e)try{return JSON.parse(e),"application/json; charset=UTF-8"}catch(e){return}return"application/json; charset=UTF-8"}(e.body)}(n),{body:c,formData:l}=function(e,t=""){if(void 0===e)return{body:void 0};if(function(e){return Boolean(e&&"function"==typeof e.getReader&&"function"==typeof e.tee)}(e))return{body:e};const n=t.split(";")[0];if("application/json"===n)return{body:JSON.stringify(e)};if(ArrayBuffer.isView(e))return{body:e instanceof Uint8Array?e:JSON.stringify(e)};switch(n){case"multipart/form-data":return function(e){return void 0!==e&&e instanceof Object&&Object.values(e).every((e=>y(e)||Array.isArray(e)&&e.every(y)))}(e)?{formData:m(e)}:{body:JSON.stringify(e)};case"text/plain":return{body:String(e)};default:return"string"==typeof e?{body:e}:{body:JSON.stringify(e)}}}(n.body,a),u=void 0!==c||void 0!==l,d=(0,o.createHttpHeaders)(Object.assign(Object.assign(Object.assign({},n.headers?n.headers:{}),{accept:null!==(s=null!==(r=n.accept)&&void 0!==r?r:null===(i=n.headers)||void 0===i?void 0:i.accept)&&void 0!==s?s:"application/json"}),u&&a&&{"content-type":a}));return(0,o.createPipelineRequest)({url:t,method:e,body:c,formData:l,headers:d,allowInsecureConnection:n.allowInsecureConnection,tracingOptions:n.tracingOptions,abortSignal:n.abortSignal,onUploadProgress:n.onUploadProgress,onDownloadProgress:n.onDownloadProgress,timeout:n.timeout,enableBrowserStreams:!0,streamResponseStatusCodes:n.responseAsStream?new Set([Number.POSITIVE_INFINITY]):void 0})}(e,t,r),l=await n.sendRequest(a,c),d=l.headers.toJSON(),p=null!==(s=l.readableStreamBody)&&void 0!==s?s:l.browserStreamBody,f=r.responseAsStream||void 0!==p?void 0:function(e){var t,n;const r=(null!==(t=e.headers.get("content-type"))&&void 0!==t?t:"").split(";")[0],i=null!==(n=e.bodyAsText)&&void 0!==n?n:"";if("text/plain"===r)return String(i);try{return i?JSON.parse(i):void 0}catch(t){if("application/json"===r)throw function(e,t){var n;const r=`Error "${t}" occurred while parsing the response body - ${e.bodyAsText}.`,i=null!==(n=t.code)&&void 0!==n?n:o.RestError.PARSE_ERROR;return new o.RestError(r,{code:i,statusCode:e.status,request:e.request,response:e})}(e,t);return String(i)}}(l),h=null!=p?p:f;return(null==r?void 0:r.onResponse)&&r.onResponse(Object.assign(Object.assign({},l),{request:c,rawHeaders:d,parsedBody:f})),{request:c,headers:d,status:`${l.status}`,body:h}}function y(e){return"string"==typeof e||e instanceof Uint8Array||"function"==typeof e.stream}function h(e){return e instanceof Uint8Array?(0,o.createFile)(e,"blob"):e}function m(e){const t={};for(const n in e){const o=e[n];t[n]=Array.isArray(o)?o.map(h):h(o)}return t}function g(e,t,n){return e&&t?e.split(t).join(n||""):e}function v(e,t,n={}){var r,i;let s;var l;t&&(void 0!==(l=t).key||(0,a.isTokenCredential)(l)?s=t:n=null!=t?t:{});const u=function(e,t,n={}){const r=(0,o.createPipelineFromOptions)(n);return r.addPolicy(function(e){return{name:c,sendRequest:(t,n)=>{const o=new URL(t.url);return!o.searchParams.get("api-version")&&e.apiVersion&&(t.url=`${t.url}${Array.from(o.searchParams.keys()).length>0?"&":"?"}api-version=${e.apiVersion}`),n(t)}}}(n)),d(r,e,{credential:t,clientOptions:n}),r}(e,s,n);if(null===(r=n.additionalPolicies)||void 0===r?void 0:r.length)for(const{policy:e,position:t}of n.additionalPolicies){const n="perRetry"===t?"Sign":void 0;u.addPolicy(e,{afterPhase:n})}const{allowInsecureConnection:p,httpClient:f}=n,y=null!==(i=n.endpoint)&&void 0!==i?i:e,h=(e,...t)=>{const n=n=>function(e,t,n,o={}){if(t.startsWith("https://")||t.startsWith("http://"))return t;e=function(e,t){var n;if(!t.pathParameters)return e;const o=t.pathParameters;for(const[r,i]of Object.entries(o)){if(null==i)throw new Error(`Path parameters ${r} must not be undefined or null`);if(!i.toString||"function"!=typeof i.toString)throw new Error(`Path parameters must be able to be represented as string, ${r} can't`);let o=void 0!==i.toISOString?i.toISOString():String(i);t.skipUrlEncoding||(o=encodeURIComponent(i)),e=null!==(n=g(e,`{${r}}`,o))&&void 0!==n?n:""}return e}(e,o),t=function(e,t,n={}){for(const o of t){let t=o;n.skipUrlEncoding||(t=encodeURIComponent(o)),e=e.replace(/\{\w+\}/,t)}return e}(t,n,o);const r=function(e,t={}){if(!t.queryParameters)return e;let n=new URL(e);const o=t.queryParameters;for(const e of Object.keys(o)){const t=o[e];if(null==t)continue;if(!t.toString||"function"!=typeof t.toString)throw new Error(`Query parameters must be able to be represented as string, ${e} can't`);const r=void 0!==t.toISOString?t.toISOString():t.toString();n.searchParams.append(e,r)}return t.skipUrlEncoding&&(n=function(e){if(!e)return e;const t=[];for(const[n,o]of e.searchParams)t.push(`${n}=${o}`);return e.search=t.length?`?${t.join("&")}`:"",e}(n)),n.toString()}(`${e}/${t}`,o);return new URL(r).toString().replace(/([^:]\/)\/+/g,"$1")}(y,e,t,Object.assign({allowInsecureConnection:p},n));return{get:(e={})=>b("GET",n(e),u,e,p,f),post:(e={})=>b("POST",n(e),u,e,p,f),put:(e={})=>b("PUT",n(e),u,e,p,f),patch:(e={})=>b("PATCH",n(e),u,e,p,f),delete:(e={})=>b("DELETE",n(e),u,e,p,f),head:(e={})=>b("HEAD",n(e),u,e,p,f),options:(e={})=>b("OPTIONS",n(e),u,e,p,f),trace:(e={})=>b("TRACE",n(e),u,e,p,f)}};return{path:h,pathUnchecked:h,pipeline:u}}function b(e,t,n,o,r,i){var s;return r=null!==(s=o.allowInsecureConnection)&&void 0!==s?s:r,{then:function(s,a){return f(e,t,n,Object.assign(Object.assign({},o),{allowInsecureConnection:r}),i).then(s,a)},asBrowserStream:async()=>f(e,t,n,Object.assign(Object.assign({},o),{allowInsecureConnection:r,responseAsStream:!0}),i),asNodeStream:async()=>f(e,t,n,Object.assign(Object.assign({},o),{allowInsecureConnection:r,responseAsStream:!0}),i)}}},305:(e,t,n)=>{"use strict";n.d(t,{l:()=>o});class o extends Error{constructor(e){super(e),this.name="AbortError"}}},76:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AzureKeyCredential:()=>o,AzureNamedKeyCredential:()=>s,AzureSASCredential:()=>c,isKeyCredential:()=>i,isNamedKeyCredential:()=>a,isSASCredential:()=>l,isTokenCredential:()=>u});class o{get key(){return this._key}constructor(e){if(!e)throw new Error("key must be a non-empty string");this._key=e}update(e){this._key=e}}var r=n(872);function i(e){return(0,r.TA)(e,["key"])&&"string"==typeof e.key}class s{get key(){return this._key}get name(){return this._name}constructor(e,t){if(!e||!t)throw new TypeError("name and key must be non-empty strings");this._name=e,this._key=t}update(e,t){if(!e||!t)throw new TypeError("newName and newKey must be non-empty strings");this._name=e,this._key=t}}function a(e){return(0,r.TA)(e,["name","key"])&&"string"==typeof e.key&&"string"==typeof e.name}class c{get signature(){return this._signature}constructor(e){if(!e)throw new Error("shared access signature must be a non-empty string");this._signature=e}update(e){if(!e)throw new Error("shared access signature must be a non-empty string");this._signature=e}}function l(e){return(0,r.TA)(e,["signature"])&&"string"==typeof e.signature}function u(e){const t=e;return t&&"function"==typeof t.getToken&&(void 0===t.signRequest||t.getToken.length>0)}},770:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RestError:()=>Se,auxiliaryAuthenticationHeaderPolicy:()=>Ke,auxiliaryAuthenticationHeaderPolicyName:()=>We,bearerTokenAuthenticationPolicy:()=>Fe,bearerTokenAuthenticationPolicyName:()=>He,createDefaultHttpClient:()=>Ae,createEmptyPipeline:()=>i,createFile:()=>q,createFileFromStream:()=>A,createHttpHeaders:()=>ie,createPipelineFromOptions:()=>Ee,createPipelineRequest:()=>je,decompressResponsePolicy:()=>$,decompressResponsePolicyName:()=>L,defaultRetryPolicy:()=>ne,exponentialRetryPolicy:()=>Ie,exponentialRetryPolicyName:()=>Te,formDataPolicy:()=>ae,formDataPolicyName:()=>se,getDefaultProxySettings:()=>ue,isRestError:()=>Oe,logPolicy:()=>y,logPolicyName:()=>f,multipartPolicy:()=>N,multipartPolicyName:()=>M,ndJsonPolicy:()=>Je,ndJsonPolicyName:()=>ze,proxyPolicy:()=>de,proxyPolicyName:()=>ce,redirectPolicy:()=>g,redirectPolicyName:()=>h,retryPolicy:()=>ee,setClientRequestIdPolicy:()=>fe,setClientRequestIdPolicyName:()=>pe,systemErrorRetryPolicy:()=>Be,systemErrorRetryPolicyName:()=>Me,throttlingRetryPolicy:()=>Ne,throttlingRetryPolicyName:()=>De,tlsPolicy:()=>he,tlsPolicyName:()=>ye,tracingPolicy:()=>Re,tracingPolicyName:()=>Pe,userAgentPolicy:()=>O,userAgentPolicyName:()=>S});const o=new Set(["Deserialize","Serialize","Retry","Sign"]);class r{constructor(e){var t;this._policies=[],this._policies=null!==(t=null==e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!o.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!o.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>n=>t.sendRequest(n,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new r(this._policies)}static create(){return new r}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const o=n("Serialize"),r=n("None"),i=n("Deserialize"),s=n("Retry"),a=n("Sign"),c=[o,r,i,s,a];function l(e){return"Retry"===e?s:"Serialize"===e?o:"Deserialize"===e?i:"Sign"===e?a:r}for(const e of this._policies){const n=e.policy,o=e.options,r=n.name;if(t.has(r))throw new Error("Duplicate policy names not allowed in pipeline");const i={policy:n,dependsOn:new Set,dependants:new Set};o.afterPhase&&(i.afterPhase=l(o.afterPhase),i.afterPhase.hasAfterPolicies=!0),t.set(r,i),l(o.phase).policies.add(i)}for(const e of this._policies){const{policy:n,options:o}=e,r=n.name,i=t.get(r);if(!i)throw new Error(`Missing node for policy ${r}`);if(o.afterPolicies)for(const e of o.afterPolicies){const n=t.get(e);n&&(i.dependsOn.add(n),n.dependants.add(i))}if(o.beforePolicies)for(const e of o.beforePolicies){const n=t.get(e);n&&(n.dependsOn.add(i),i.dependants.add(n))}}function u(n){n.hasRun=!0;for(const o of n.policies)if((!o.afterPhase||o.afterPhase.hasRun&&!o.afterPhase.policies.size)&&0===o.dependsOn.size){e.push(o.policy);for(const e of o.dependants)e.dependsOn.delete(o);t.delete(o.policy.name),n.policies.delete(o)}}function d(){for(const e of c){if(u(e),e.policies.size>0&&e!==r)return void(r.hasRun||u(r));e.hasAfterPolicies&&u(r)}}let p=0;for(;t.size>0;){p++;const t=e.length;if(d(),e.length<=t&&p>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function i(){return r.create()}var s=n(417);const a=(0,s.createClientLogger)("core-rest-pipeline");var c=n(872);const l="REDACTED",u=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],d=["api-version"];class p{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=u.concat(e),t=d.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||(0,c.Gv)(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}}),2)}sanitizeUrl(e){if("string"!=typeof e||null===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,l);return t.toString()}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=l;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=l;return t}}const f="logPolicy";function y(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:a.info,o=new p({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:f,async sendRequest(e,t){if(!n.enabled)return t(e);n(`Request: ${o.sanitize(e)}`);const r=await t(e);return n(`Response status code: ${r.status}`),n(`Headers: ${o.sanitize(r.headers)}`),r}}}const h="redirectPolicy",m=["GET","HEAD"];function g(e={}){const{maxRetries:t=20}=e;return{name:h,async sendRequest(e,n){const o=await n(e);return v(n,o,t)}}}async function v(e,t,n,o=0){const{request:r,status:i,headers:s}=t,a=s.get("location");if(a&&(300===i||301===i&&m.includes(r.method)||302===i&&m.includes(r.method)||303===i&&"POST"===r.method||307===i)&&o<n){const t=new URL(a,r.url);r.url=t.toString(),303===i&&(r.method="GET",r.headers.delete("Content-Length"),delete r.body),r.headers.delete("Authorization");const s=await e(r);return v(e,s,n,o+1)}return t}const b="1.16.1",w=3;async function _(e){const t=new Map;t.set("core-rest-pipeline",b),await async function(e){const t=globalThis.navigator;let n="unknown";if(t.userAgentData){const o=await t.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);n=`${o.architecture}-${o.platform}-${o.platformVersion}`;const r=function(e){const t=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(const n of t){const t=e.find((e=>e.brand===n));if(t)return t}}(t.userAgentData.brands);r&&e.set(r.brand,r.version)}else if(null==t?void 0:t.platform){n=t.platform;const o=function(e){const t=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(const n of t){const t=e.match(n.regex);if(t)return{brand:n.name,version:t[1]}}}(t.userAgent);o&&e.set(o.brand,o.version)}e.set("OS",n)}(t);const n=function(e){const t=[];for(const[n,o]of e){const e=o?`${n}/${o}`:n;t.push(e)}return t.join(" ")}(t);return e?`${e} ${n}`:n}const x="x-ms-useragent",S="userAgentPolicy";function O(e={}){const t=_(e.userAgentPrefix);return{name:S,sendRequest:async(e,n)=>(e.headers.has(x)||e.headers.set(x,await t),n(e))}}function P(e){return Boolean(e&&"function"==typeof e.pipe)}function R(e){return Boolean(e&&"function"==typeof e.getReader&&"function"==typeof e.tee)}const E={arrayBuffer:()=>{throw new Error("Not implemented")},slice:()=>{throw new Error("Not implemented")},text:()=>{throw new Error("Not implemented")}},C=Symbol("rawContent");function k(e){return"function"==typeof e[C]?e[C]():e.stream()}function A(e,t,n={}){var o,r,i,s;return Object.assign(Object.assign({},E),{type:null!==(o=n.type)&&void 0!==o?o:"",lastModified:null!==(r=n.lastModified)&&void 0!==r?r:(new Date).getTime(),webkitRelativePath:null!==(i=n.webkitRelativePath)&&void 0!==i?i:"",size:null!==(s=n.size)&&void 0!==s?s:-1,name:t,stream:()=>{const t=e();if(P(t))throw new Error("Not supported: a Node stream was provided as input to createFileFromStream.");return t},[C]:e})}function q(e,t,n={}){var o,r,i;return c.qx?Object.assign(Object.assign({},E),{type:null!==(o=n.type)&&void 0!==o?o:"",lastModified:null!==(r=n.lastModified)&&void 0!==r?r:(new Date).getTime(),webkitRelativePath:null!==(i=n.webkitRelativePath)&&void 0!==i?i:"",size:e.byteLength,name:t,arrayBuffer:async()=>e.buffer,stream:()=>new Blob([e]).stream(),[C]:()=>e}):new File([e],t,n)}async function j(e){if(e instanceof Blob||e instanceof Uint8Array)return e;if(R(e))return new Response(e).blob();const t=k(e);if(P(t))throw new Error("Encountered unexpected type. In the browser, `concat` supports Web ReadableStream, Blob, Uint8Array, and files created using `createFile` only.");return j(t)}function T(e){let t="";for(const[n,o]of e)t+=`${n}: ${o}\r\n`;return t}function I(e){return e instanceof Uint8Array?e.byteLength:"function"==typeof e.stream?-1===e.size?void 0:e.size:void 0}const M="multipartPolicy",B=70,D=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function N(){return{name:M,async sendRequest(e,t){var n;if(!e.multipartBody)return t(e);if(e.body)throw new Error("multipartBody and regular body cannot be set at the same time");let o=e.multipartBody.boundary;const r=null!==(n=e.headers.get("Content-Type"))&&void 0!==n?n:"multipart/mixed",i=r.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!i)throw new Error(`Got multipart request body, but content-type header was not multipart: ${r}`);const[,s,a]=i;if(a&&o&&a!==o)throw new Error(`Multipart boundary was specified as ${a} in the header, but got ${o} in the request body`);return null!=o||(o=a),o?function(e){if(e.length>B)throw new Error(`Multipart boundary "${e}" exceeds maximum length of 70 characters`);if(Array.from(e).some((e=>!D.has(e))))throw new Error(`Multipart boundary "${e}" contains invalid characters`)}(o):o=`----AzSDKFormBoundary${(0,c.N4)()}`,e.headers.set("Content-Type",`${s}; boundary=${o}`),await async function(e,t,n){const o=[(0,c.Al)(`--${n}`,"utf-8"),...t.flatMap((e=>[(0,c.Al)("\r\n","utf-8"),(0,c.Al)(T(e.headers),"utf-8"),(0,c.Al)("\r\n","utf-8"),e.body,(0,c.Al)(`\r\n--${n}`,"utf-8")])),(0,c.Al)("--\r\n\r\n","utf-8")],r=function(e){let t=0;for(const n of e){const e=I(n);if(void 0===e)return;t+=e}return t}(o);r&&e.headers.set("Content-Length",r),e.body=await async function(e){const t=[];for(const n of e)t.push(await j("function"==typeof n?n():n));return new Blob(t)}(o)}(e,e.multipartBody.parts,o),e.multipartBody=void 0,t(e)}}}const L="decompressResponsePolicy";function $(){throw new Error("decompressResponsePolicy is not supported in browser environment")}var H=n(305);const U="The operation was aborted.";function F(e,t,n){return new Promise(((o,r)=>{let i,s;const a=()=>r(new H.l((null==n?void 0:n.abortErrorMsg)?null==n?void 0:n.abortErrorMsg:U)),c=()=>{(null==n?void 0:n.abortSignal)&&s&&n.abortSignal.removeEventListener("abort",s)};if(s=()=>(i&&clearTimeout(i),c(),a()),(null==n?void 0:n.abortSignal)&&n.abortSignal.aborted)return a();i=setTimeout((()=>{c(),o(t)}),e),(null==n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",s)}))}function z(e,t){const n=e.headers.get(t);if(!n)return;const o=Number(n);return Number.isNaN(o)?void 0:o}const J="Retry-After",W=["retry-after-ms","x-ms-retry-after-ms",J];function V(e){if(e&&[429,503].includes(e.status))try{for(const t of W){const n=z(e,t);if(0===n||n)return n*(t===J?1e3:1)}const t=e.headers.get(J);if(!t)return;const n=Date.parse(t)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch(e){return}}function G(){return{name:"throttlingRetryStrategy",retry({response:e}){const t=V(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}}}const K=1e3,Q=64e3;function Y(e={}){var t,n;const o=null!==(t=e.retryDelayInMs)&&void 0!==t?t:K,r=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:Q;let i=o;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:o}){const s=!!(p=o)&&("ETIMEDOUT"===p.code||"ESOCKETTIMEDOUT"===p.code||"ECONNREFUSED"===p.code||"ECONNRESET"===p.code||"ENOENT"===p.code||"ENOTFOUND"===p.code),a=s&&e.ignoreSystemErrors,l=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),u=l&&e.ignoreHttpStatusCodes,d=n&&(function(e){return Number.isFinite(V(e))}(n)||!l);var p;if(d||u||a)return{skipStrategy:!0};if(o&&!s&&!l)return{errorToThrow:o};const f=i*Math.pow(2,t),y=Math.min(r,f);return i=y/2+(0,c.Wq)(0,y/2),{retryAfterInMs:i}}}}const X=(0,s.createClientLogger)("core-rest-pipeline retryPolicy"),Z="retryPolicy";function ee(e,t={maxRetries:w}){const n=t.logger||X;return{name:Z,async sendRequest(o,r){var i,s;let a,c,l=-1;e:for(;;){l+=1,a=void 0,c=void 0;try{n.info(`Retry ${l}: Attempting to send request`,o.requestId),a=await r(o),n.info(`Retry ${l}: Received a response from request`,o.requestId)}catch(e){if(n.error(`Retry ${l}: Received an error from request`,o.requestId),c=e,!e||"RestError"!==c.name)throw e;a=c.response}if(null===(i=o.abortSignal)||void 0===i?void 0:i.aborted)throw n.error(`Retry ${l}: Request aborted.`),new H.l;if(l>=(null!==(s=t.maxRetries)&&void 0!==s?s:w)){if(n.info(`Retry ${l}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${l}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||X;e.info(`Retry ${l}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:l,response:a,responseError:c});if(n.skipStrategy){e.info(`Retry ${l}: Skipped.`);continue t}const{errorToThrow:r,retryAfterInMs:i,redirectTo:s}=n;if(r)throw e.error(`Retry ${l}: Retry strategy ${t.name} throws error:`,r),r;if(i||0===i){e.info(`Retry ${l}: Retry strategy ${t.name} retries after ${i}`),await F(i,void 0,{abortSignal:o.abortSignal});continue e}if(s){e.info(`Retry ${l}: Retry strategy ${t.name} redirects to ${s}`),o.url=s;continue e}}if(c)throw n.info("None of the retry strategies could work with the received error. Throwing it."),c;if(a)return n.info("None of the retry strategies could work with the received response. Returning it."),a}}}}const te="defaultRetryPolicy";function ne(e={}){var t;return{name:te,sendRequest:ee([G(),Y(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:w}).sendRequest}}function oe(e){return e.toLowerCase()}class re{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(oe(e),{name:e,value:String(t).trim()})}get(e){var t;return null===(t=this._headersMap.get(oe(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(oe(e))}delete(e){this._headersMap.delete(oe(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,n]of this._headersMap)t[e]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function ie(e){return new re(e)}const se="formDataPolicy";function ae(){return{name:se,async sendRequest(e,t){if(c.qx&&"undefined"!=typeof FormData&&e.body instanceof FormData&&(e.formData=function(e){var t;const n={};for(const[o,r]of e.entries())null!==(t=n[o])&&void 0!==t||(n[o]=[]),n[o].push(r);return n}(e.body),e.body=void 0),e.formData){const t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?e.body=function(e){const t=new URLSearchParams;for(const[n,o]of Object.entries(e))if(Array.isArray(o))for(const e of o)t.append(n,e.toString());else t.append(n,o.toString());return t.toString()}(e.formData):await async function(e,t){const n=t.headers.get("Content-Type");if(n&&!n.startsWith("multipart/form-data"))return;t.headers.set("Content-Type",null!=n?n:"multipart/form-data");const o=[];for(const[t,n]of Object.entries(e))for(const e of Array.isArray(n)?n:[n])if("string"==typeof e)o.push({headers:ie({"Content-Disposition":`form-data; name="${t}"`}),body:(0,c.Al)(e,"utf-8")});else{if(null==e||"object"!=typeof e)throw new Error(`Unexpected value for key ${t}: ${e}. Value should be serialized to string first.`);{const n=e.name||"blob",r=ie();r.set("Content-Disposition",`form-data; name="${t}"; filename="${n}"`),r.set("Content-Type",e.type||"application/octet-stream"),o.push({headers:r,body:e})}}t.multipartBody={parts:o}}(e.formData,e),e.formData=void 0}return t(e)}}}const ce="proxyPolicy",le="proxyPolicy is not supported in browser environment";function ue(){throw new Error(le)}function de(){throw new Error(le)}const pe="setClientRequestIdPolicy";function fe(e="x-ms-client-request-id"){return{name:pe,sendRequest:async(t,n)=>(t.headers.has(e)||t.headers.set(e,t.requestId),n(t))}}const ye="tlsPolicy";function he(e){return{name:ye,sendRequest:async(t,n)=>(t.tlsSettings||(t.tlsSettings=e),n(t))}}const me={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function ge(e={}){let t=new ve(e.parentContext);return e.span&&(t=t.setValue(me.span,e.span)),e.namespace&&(t=t.setValue(me.namespace,e.namespace)),t}class ve{constructor(e){this._contextMap=e instanceof ve?new Map(e._contextMap):new Map}setValue(e,t){const n=new ve(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new ve(this);return t._contextMap.delete(e),t}}const be={instrumenterImplementation:void 0};function we(){return be.instrumenterImplementation||(be.instrumenterImplementation={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:ge({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}),be.instrumenterImplementation}const _e={},xe=new p;class Se extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,Se.prototype)}[_e](){return`RestError: ${this.message} \n ${xe.sanitize(this)}`}}function Oe(e){return e instanceof Se||(0,c.bJ)(e)&&"RestError"===e.name}Se.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",Se.PARSE_ERROR="PARSE_ERROR";const Pe="tracingPolicy";function Re(e={}){const t=_(e.userAgentPrefix),n=new p({additionalAllowedQueryParameters:e.additionalAllowedQueryParameters}),o=function(){try{return function(e){const{namespace:t,packageName:n,packageVersion:o}=e;function r(e,r,i){var s;const a=we().startSpan(e,Object.assign(Object.assign({},i),{packageName:n,packageVersion:o,tracingContext:null===(s=null==r?void 0:r.tracingOptions)||void 0===s?void 0:s.tracingContext}));let c=a.tracingContext;const l=a.span;return c.getValue(me.namespace)||(c=c.setValue(me.namespace,t)),l.setAttribute("az.namespace",c.getValue(me.namespace)),{span:l,updatedOptions:Object.assign({},r,{tracingOptions:Object.assign(Object.assign({},null==r?void 0:r.tracingOptions),{tracingContext:c})})}}function i(e,t,...n){return we().withContext(e,t,...n)}return{startSpan:r,withSpan:async function(e,t,n,o){const{span:s,updatedOptions:a}=r(e,t,o);try{const e=await i(a.tracingOptions.tracingContext,(()=>Promise.resolve(n(a,s))));return s.setStatus({status:"success"}),e}catch(e){throw s.setStatus({status:"error",error:e}),e}finally{s.end()}},withContext:i,parseTraceparentHeader:function(e){return we().parseTraceparentHeader(e)},createRequestHeaders:function(e){return we().createRequestHeaders(e)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:b})}catch(e){return void a.warning(`Error when creating the TracingClient: ${(0,c.u1)(e)}`)}}();return{name:Pe,async sendRequest(e,r){var i,s;if(!o||!(null===(i=e.tracingOptions)||void 0===i?void 0:i.tracingContext))return r(e);const l=await t,u={"http.url":n.sanitizeUrl(e.url),"http.method":e.method,"http.user_agent":l,requestId:e.requestId};l&&(u["http.user_agent"]=l);const{span:d,tracingContext:p}=null!==(s=function(e,t,n){try{const{span:o,updatedOptions:r}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:n});if(!o.isRecording())return void o.end();const i=e.createRequestHeaders(r.tracingOptions.tracingContext);for(const[e,n]of Object.entries(i))t.headers.set(e,n);return{span:o,tracingContext:r.tracingOptions.tracingContext}}catch(e){return void a.warning(`Skipping creating a tracing span due to an error: ${(0,c.u1)(e)}`)}}(o,e,u))&&void 0!==s?s:{};if(!d||!p)return r(e);try{const t=await o.withContext(p,r,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(e){a.warning(`Skipping tracing span processing due to an error: ${(0,c.u1)(e)}`)}}(d,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:(0,c.bJ)(t)?t:void 0}),Oe(t)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(e){a.warning(`Skipping tracing span processing due to an error: ${(0,c.u1)(e)}`)}}(d,e),e}}}}function Ee(e){var t;const n=i();return c.qx&&(e.tlsOptions&&n.addPolicy(he(e.tlsOptions)),n.addPolicy(de(e.proxyOptions)),n.addPolicy($())),n.addPolicy(ae(),{beforePolicies:[M]}),n.addPolicy(O(e.userAgentOptions)),n.addPolicy(fe(null===(t=e.telemetryOptions)||void 0===t?void 0:t.clientRequestIdHeaderName)),n.addPolicy(N(),{afterPhase:"Deserialize"}),n.addPolicy(ne(e.retryOptions),{phase:"Retry"}),n.addPolicy(Re(Object.assign(Object.assign({},e.userAgentOptions),e.loggingOptions)),{afterPhase:"Retry"}),c.qx&&n.addPolicy(g(e.redirectOptions),{afterPhase:"Retry"}),n.addPolicy(y(e.loggingOptions),{afterPhase:"Sign"}),n}class Ce{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:n}=function(e){const t=new AbortController;let n,o;if(e.abortSignal){if(e.abortSignal.aborted)throw new H.l("The operation was aborted.");o=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",o),n=()=>{var t;o&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",o))}}return e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout),{abortController:t,abortControllerCleanup:n}}(e);try{const r=function(e){const t=new Headers;for(const[n,o]of e)t.append(n,o);return t}(e.headers),{streaming:i,body:s}=function(e){const t="function"==typeof e.body?e.body():e.body;if(P(t))throw new Error("Node streams are not supported in browser environment.");return R(t)?{streaming:!0,body:ke(t,{onProgress:e.onUploadProgress})}:{streaming:!1,body:t}}(e),a=Object.assign(Object.assign({body:s,method:e.method,headers:r,signal:t.signal},"credentials"in Request.prototype?{credentials:e.withCredentials?"include":"same-origin"}:{}),"cache"in Request.prototype?{cache:"no-store"}:{});i&&(a.duplex="half");const c=await fetch(e.url,a);return o=e.body,("function"==typeof Blob||"object"==typeof Blob)&&o instanceof Blob&&e.onUploadProgress&&e.onUploadProgress({loadedBytes:e.body.size}),async function(e,t,n){var o,r;const i=function(e){const t=ie();for(const[n,o]of e.headers)t.set(n,o);return t}(e),s={request:t,headers:i,status:e.status},a=R(e.body)?ke(e.body,{onProgress:t.onDownloadProgress,onEnd:n}):e.body;if((null===(o=t.streamResponseStatusCodes)||void 0===o?void 0:o.has(Number.POSITIVE_INFINITY))||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(s.status)))if(t.enableBrowserStreams)s.browserStreamBody=null!=a?a:void 0;else{const e=new Response(a);s.blobBody=e.blob(),null==n||n()}else{const e=new Response(a);s.bodyAsText=await e.text(),null==n||n()}return s}(c,e,n)}catch(e){throw null==n||n(),e}var o}(e)}catch(t){throw function(e,t){var n;return e&&"AbortError"===(null==e?void 0:e.name)?e:new Se(`Error sending request: ${e.message}`,{code:null!==(n=null==e?void 0:e.code)&&void 0!==n?n:Se.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function ke(e,t={}){let n=0;const{onProgress:o,onEnd:r}=t;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,t){null!==e?(t.enqueue(e),n+=e.length,o&&o({loadedBytes:n})):t.terminate()},flush(){null==r||r()}}));{const t=e.getReader();return new ReadableStream({async pull(e){var i;const{done:s,value:a}=await t.read();if(s||!a)return null==r||r(),e.close(),void t.releaseLock();n+=null!==(i=null==a?void 0:a.length)&&void 0!==i?i:0,e.enqueue(a),o&&o({loadedBytes:n})},cancel:e=>(null==r||r(),t.cancel(e))})}}function Ae(){return new Ce}class qe{constructor(e){var t,n,o,r,i,s,a;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:ie(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(o=e.timeout)&&void 0!==o?o:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=null!==(r=e.disableKeepAlive)&&void 0!==r&&r,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(i=e.withCredentials)&&void 0!==i&&i,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||(0,c.N4)(),this.allowInsecureConnection=null!==(s=e.allowInsecureConnection)&&void 0!==s&&s,this.enableBrowserStreams=null!==(a=e.enableBrowserStreams)&&void 0!==a&&a}}function je(e){return new qe(e)}const Te="exponentialRetryPolicy";function Ie(e={}){var t;return ee([Y(Object.assign(Object.assign({},e),{ignoreSystemErrors:!0}))],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:w})}const Me="systemErrorRetryPolicy";function Be(e={}){var t;return{name:Me,sendRequest:ee([Y(Object.assign(Object.assign({},e),{ignoreHttpStatusCodes:!0}))],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:w}).sendRequest}}const De="throttlingRetryPolicy";function Ne(e={}){var t;return{name:De,sendRequest:ee([G()],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:w}).sendRequest}}const Le={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function $e(e,t){let n,o=null,r=null;const i=Object.assign(Object.assign({},Le),t),s={get isRefreshing(){return null!==o},get shouldRefresh(){var e;return!s.isRefreshing&&(null!==(e=null==r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-i.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-i.forcedRefreshWindowInMs<Date.now()}};function a(t,a){var c;return s.isRefreshing||(o=async function(e,t,n){async function o(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let r=await o();for(;null===r;)await F(t),r=await o();return r}((()=>e.getToken(t,a)),i.retryIntervalInMs,null!==(c=null==r?void 0:r.expiresOnTimestamp)&&void 0!==c?c:Date.now()).then((e=>(o=null,r=e,n=a.tenantId,r))).catch((e=>{throw o=null,r=null,n=void 0,e}))),o}return async(e,t)=>{const o=Boolean(t.claims),i=n!==t.tenantId;return o&&(r=null),i||o||s.mustRefresh?a(e,t):(s.shouldRefresh&&a(e,t),r)}}const He="bearerTokenAuthenticationPolicy";async function Ue(e){const{scopes:t,getAccessToken:n,request:o}=e,r={abortSignal:o.abortSignal,tracingOptions:o.tracingOptions},i=await n(t,r);i&&e.request.headers.set("Authorization",`Bearer ${i.token}`)}function Fe(e){var t;const{credential:n,scopes:o,challengeCallbacks:r}=e,i=e.logger||a,s=Object.assign({authorizeRequest:null!==(t=null==r?void 0:r.authorizeRequest)&&void 0!==t?t:Ue,authorizeRequestOnChallenge:null==r?void 0:r.authorizeRequestOnChallenge},r),c=n?$e(n):()=>Promise.resolve(null);return{name:He,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,r;await s.authorizeRequest({scopes:Array.isArray(o)?o:[o],request:e,getAccessToken:c,logger:i});try{n=await t(e)}catch(e){r=e,n=e.response}if(s.authorizeRequestOnChallenge&&401===(null==n?void 0:n.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(n)&&await s.authorizeRequestOnChallenge({scopes:Array.isArray(o)?o:[o],request:e,response:n,getAccessToken:c,logger:i}))return t(e);if(r)throw r;return n}}}const ze="ndJsonPolicy";function Je(){return{name:ze,async sendRequest(e,t){if("string"==typeof e.body&&e.body.startsWith("[")){const t=JSON.parse(e.body);Array.isArray(t)&&(e.body=t.map((e=>JSON.stringify(e)+"\n")).join(""))}return t(e)}}}const We="auxiliaryAuthenticationHeaderPolicy",Ve="x-ms-authorization-auxiliary";async function Ge(e){var t,n;const{scopes:o,getAccessToken:r,request:i}=e,s={abortSignal:i.abortSignal,tracingOptions:i.tracingOptions};return null!==(n=null===(t=await r(o,s))||void 0===t?void 0:t.token)&&void 0!==n?n:""}function Ke(e){const{credentials:t,scopes:n}=e,o=e.logger||a,r=new WeakMap;return{name:We,async sendRequest(e,i){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication for auxiliary header is not permitted for non-TLS protected (non-https) URLs.");if(!t||0===t.length)return o.info(`${We} header will not be set due to empty credentials.`),i(e);const s=[];for(const i of t){let t=r.get(i);t||(t=$e(i),r.set(i,t)),s.push(Ge({scopes:Array.isArray(n)?n:[n],request:e,getAccessToken:t,logger:o}))}const a=(await Promise.all(s)).filter((e=>Boolean(e)));return 0===a.length?(o.warning(`None of the auxiliary tokens are valid. ${Ve} header will not be set.`),i(e)):(e.headers.set(Ve,a.map((e=>`Bearer ${e}`)).join(", ")),i(e))}}}},859:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createSseStream:()=>a});var o,r=n(635);function i(e){e[Symbol.asyncIterator]||(e[Symbol.asyncIterator]=()=>s(e)),e.values||(e.values=()=>s(e))}function s(e){return(0,r.__asyncGenerator)(this,arguments,(function*(){const t=e.getReader();try{for(;;){const{value:e,done:n}=yield(0,r.__await)(t.read());if(n)return yield(0,r.__await)(void 0);yield yield(0,r.__await)(e)}}finally{const e=t.cancel();t.releaseLock(),yield(0,r.__await)(e)}}))}function a(e){const{cancel:t,iterable:n}=(l=a=e,Boolean(l&&"function"==typeof l.getReader&&"function"==typeof l.tee)?(i(a),{cancel:()=>a.cancel(),iterable:a}):{cancel:async()=>{a.socket.end()},iterable:a}),s=function(e){return(0,r.__asyncGenerator)(this,arguments,(function*(){var t,n,i,s;let a={data:void 0,event:"",id:"",retry:void 0};const c=new TextDecoder;try{for(var l,u=!0,d=(0,r.__asyncValues)(e);!(t=(l=yield(0,r.__await)(d.next())).done);u=!0){s=l.value,u=!1;const{line:e,fieldLen:t}=s;if(0===e.length&&void 0!==a.data)yield yield(0,r.__await)(a),a={data:void 0,event:"",id:"",retry:void 0};else if(t>0){const n=c.decode(e.subarray(0,t)),r=t+(e[t+1]===o.Space?2:1),i=c.decode(e.subarray(r));switch(n){case"data":a.data=a.data?a.data+"\n"+i:i;break;case"event":a.event=i;break;case"id":a.id=i;break;case"retry":{const e=parseInt(i,10);isNaN(e)||(a.retry=e);break}}}}}catch(e){n={error:e}}finally{try{u||t||!(i=d.return)||(yield(0,r.__await)(i.call(d)))}finally{if(n)throw n.error}}}))}(function(e){return(0,r.__asyncGenerator)(this,arguments,(function*(){var t,n,i,s;let a,l=0,u=-1,d=!1;try{for(var p,f=!0,y=(0,r.__asyncValues)(e);!(t=(p=yield(0,r.__await)(y.next())).done);f=!0){s=p.value,f=!1,void 0===a?(a=s,l=0,u=-1):a=c(a,s);const e=a.length;let t=0;for(;l<e;){d&&(a[l]===o.NewLine&&(t=++l),d=!1);let n=-1;for(;l<e&&-1===n;++l)switch(a[l]){case o.Colon:-1===u&&(u=l-t);break;case o.CarriageReturn:d=!0,n=l;break;case o.NewLine:n=l}if(-1===n)break;yield yield(0,r.__await)({line:a.subarray(t,n),fieldLen:u}),t=l,u=-1}t===e?a=void 0:0!==t&&(a=a.subarray(t),l-=t)}}catch(e){n={error:e}}finally{try{f||t||!(i=y.return)||(yield(0,r.__await)(i.call(y)))}finally{if(n)throw n.error}}}))}(n));var a,l;return function(e,t){const n=function(e,t){return new ReadableStream({async pull(t){const{value:n,done:o}=await e.next();o?t.close():t.enqueue(n)},cancel:t})}(e,t);return function(e,t){return i(e),function(e,t){var n;null!==(n=Symbol.asyncDispose)&&void 0!==n||(Symbol.asyncDispose=Symbol("Symbol.asyncDispose")),e[Symbol.asyncDispose]||(e[Symbol.asyncDispose]=()=>t())}(e,t),e}(n,t)}(s,t)}function c(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}!function(e){e[e.NewLine=10]="NewLine",e[e.CarriageReturn=13]="CarriageReturn",e[e.Space=32]="Space",e[e.Colon=58]="Colon"}(o||(o={}))},872:(e,t,n)=>{"use strict";function o(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function r(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function i(e){if(r(e)){const t="string"==typeof e.name,n="string"==typeof e.message;return t&&n}return!1}function s(e){if(i(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}function a(e,t){switch(t){case"utf-8":return function(e){return(new TextEncoder).encode(e)}(e);case"base64":return c(e);case"base64url":return function(e){return c(e.replace(/-/g,"+").replace(/_/g,"/"))}(e);case"hex":return function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<e.length/2;++n){const o=e[2*n],r=e[2*n+1];if(!l.has(o)||!l.has(r))return t.slice(0,n);t[n]=parseInt(`${o}${r}`,16)}return t}(e)}}function c(e){return new Uint8Array([...atob(e)].map((e=>e.charCodeAt(0))))}n.d(t,{u1:()=>s,Wq:()=>o,bJ:()=>i,qx:()=>w,Gv:()=>r,TA:()=>d,N4:()=>h,Al:()=>a}),n(305);const l=new Set("0123456789abcdefABCDEF");function u(e){return null!=e}function d(e,t){if(!u(e)||"object"!=typeof e)return!1;for(const n of t)if(!p(e,n))return!1;return!0}function p(e,t){return u(e)&&"object"==typeof e&&t in e}var f;const y="function"==typeof(null===(f=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===f?void 0:f.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):function(){let e="";for(let t=0;t<32;t++){const n=Math.floor(16*Math.random());e+=12===t?"4":16===t?3&n|8:n.toString(16),7!==t&&11!==t&&15!==t&&19!==t||(e+="-")}return e};function h(){return y()}var m,g,v,b;"undefined"!=typeof window&&window.document,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(m=self.constructor)||void 0===m?void 0:m.name)||"ServiceWorkerGlobalScope"===(null===(g=self.constructor)||void 0===g?void 0:g.name)||null===(v=self.constructor)||void 0===v||v.name),"undefined"!=typeof Deno&&void 0!==Deno.version&&Deno.version.deno,"undefined"!=typeof Bun&&Bun.version;const w=void 0!==globalThis.process&&Boolean(globalThis.process.version)&&Boolean(null===(b=globalThis.process.versions)||void 0===b?void 0:b.node);"undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator.product)},417:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AzureLogger:()=>v,createClientLogger:()=>S,getLogLevel:()=>_,setLogLevel:()=>w});const o="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let r,i=[],s=[];const a=[];o&&l(o);const c=Object.assign((e=>d(e)),{enable:l,enabled:u,disable:function(){const e=r||"";return l(""),e},log:function(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}});function l(e){r=e,i=[],s=[];const t=/\*/g,n=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const e of n)e.startsWith("-")?s.push(new RegExp(`^${e.substr(1)}$`)):i.push(new RegExp(`^${e}$`));for(const e of a)e.enabled=u(e.namespace)}function u(e){if(e.endsWith("*"))return!0;for(const t of s)if(t.test(e))return!1;for(const t of i)if(t.test(e))return!0;return!1}function d(e){const t=Object.assign((function(...n){t.enabled&&(n.length>0&&(n[0]=`${e} ${n[0]}`),t.log(...n))}),{enabled:u(e),destroy:p,log:c.log,namespace:e,extend:f});return a.push(t),t}function p(){const e=a.indexOf(this);return e>=0&&(a.splice(e,1),!0)}function f(e){const t=d(`${this.namespace}:${e}`);return t.log=this.log,t}const y=c,h=new Set,m="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let g;const v=y("azure");v.log=(...e)=>{y.log(...e)};const b=["verbose","info","warning","error"];function w(e){if(e&&!E(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${b.join(",")}`);g=e;const t=[];for(const e of h)R(e)&&t.push(e.namespace);y.enable(t.join(","))}function _(){return g}m&&(E(m)?w(m):console.error(`AZURE_LOG_LEVEL set to unknown log level '${m}'; logging is not enabled. Acceptable values: ${b.join(", ")}.`));const x={verbose:400,info:300,warning:200,error:100};function S(e){const t=v.extend(e);return O(v,t),{error:P(t,"error"),warning:P(t,"warning"),info:P(t,"info"),verbose:P(t,"verbose")}}function O(e,t){t.log=(...t)=>{e.log(...t)}}function P(e,t){const n=Object.assign(e.extend(t),{level:t});if(O(e,n),R(n)){const e=y.disable();y.enable(e+","+n.namespace)}return h.add(n),n}function R(e){return Boolean(g&&x[e.level]<=x[g])}function E(e){return b.includes(e)}},635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>I,__assign:()=>i,__asyncDelegator:()=>P,__asyncGenerator:()=>O,__asyncValues:()=>R,__await:()=>S,__awaiter:()=>y,__classPrivateFieldGet:()=>q,__classPrivateFieldIn:()=>T,__classPrivateFieldSet:()=>j,__createBinding:()=>m,__decorate:()=>a,__disposeResources:()=>B,__esDecorate:()=>l,__exportStar:()=>g,__extends:()=>r,__generator:()=>h,__importDefault:()=>A,__importStar:()=>k,__makeTemplateObject:()=>E,__metadata:()=>f,__param:()=>c,__propKey:()=>d,__read:()=>b,__rest:()=>s,__runInitializers:()=>u,__setFunctionName:()=>p,__spread:()=>w,__spreadArray:()=>x,__spreadArrays:()=>_,__values:()=>v,default:()=>D});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)};function s(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function a(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function c(e,t){return function(n,o){t(n,o,e)}}function l(e,t,n,o,r,i){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=o.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?o.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),p=!1,f=n.length-1;f>=0;f--){var y={};for(var h in o)y[h]="access"===h?{}:o[h];for(var h in o.access)y.access[h]=o.access[h];y.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(e||null))};var m=(0,n[f])("accessor"===c?{get:d.get,set:d.set}:d[l],y);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=s(m.get))&&(d.get=a),(a=s(m.set))&&(d.set=a),(a=s(m.init))&&r.unshift(a)}else(a=s(m))&&("field"===c?r.unshift(a):d[l]=a)}u&&Object.defineProperty(u,o.name,d),p=!0}function u(e,t,n){for(var o=arguments.length>2,r=0;r<t.length;r++)n=o?t[r].call(e,n):t[r].call(e);return o?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))}function h(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var m=Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]};function g(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o}function x(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function O(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),i=[];return o={},s("next"),s("throw"),s("return",(function(e){return function(t){return Promise.resolve(t).then(e,l)}})),o[Symbol.asyncIterator]=function(){return this},o;function s(e,t){r[e]&&(o[e]=function(t){return new Promise((function(n,o){i.push([e,t,n,o])>1||a(e,t)}))},t&&(o[e]=t(o[e])))}function a(e,t){try{(n=r[e](t)).value instanceof S?Promise.resolve(n.value.v).then(c,l):u(i[0][2],n)}catch(e){u(i[0][3],e)}var n}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function P(e){var t,n;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:S(e[o](t)),done:!1}:r?r(t):t}:r}}function R(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return C(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function q(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function j(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n}function T(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function I(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose],n&&(r=o)}if("function"!=typeof o)throw new TypeError("Object not disposable.");r&&(o=function(){try{r.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:o,async:n})}else n&&e.stack.push({async:!0});return t}var M="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var o=new Error(n);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function B(e){function t(t){e.error=e.hasError?new M(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var o=e.stack.pop();try{var r=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(r).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const D={__extends:r,__assign:i,__rest:s,__decorate:a,__param:c,__metadata:f,__awaiter:y,__generator:h,__createBinding:m,__exportStar:g,__values:v,__read:b,__spread:w,__spreadArrays:_,__spreadArray:x,__await:S,__asyncGenerator:O,__asyncDelegator:P,__asyncValues:R,__makeTemplateObject:E,__importStar:k,__importDefault:A,__classPrivateFieldGet:q,__classPrivateFieldSet:j,__classPrivateFieldIn:T,__addDisposableResource:I,__disposeResources:B}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function i(){"use strict";i=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function p(e,t,n,o){var r=t&&t.prototype instanceof b?t:b,i=Object.create(r.prototype),a=new j(o||[]);return s(i,"_invoke",{value:C(e,n,a)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var y="suspendedStart",h="suspendedYield",m="executing",g="completed",v={};function b(){}function w(){}function _(){}var x={};d(x,c,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(T([])));O&&O!==n&&r.call(O,c)&&(x=O);var P=_.prototype=b.prototype=Object.create(x);function R(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,s,a,c){var l=f(e[i],e,s);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==o(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(l.arg)}var i;s(this,"_invoke",{value:function(e,o){function r(){return new t((function(t,r){n(e,o,t,r)}))}return i=i?i.then(r,r):r()}})}function C(t,n,o){var r=y;return function(i,s){if(r===m)throw Error("Generator is already running");if(r===g){if("throw"===i)throw s;return{value:e,done:!0}}for(o.method=i,o.arg=s;;){var a=o.delegate;if(a){var c=k(a,o);if(c){if(c===v)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===y)throw r=g,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=m;var l=f(t,n,o);if("normal"===l.type){if(r=o.done?g:h,l.arg===v)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=g,o.method="throw",o.arg=l.arg)}}}function k(t,n){var o=n.method,r=t.iterator[o];if(r===e)return n.delegate=null,"throw"===o&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),v;var i=f(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function q(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw new TypeError(o(t)+" is not iterable")}return w.prototype=_,s(P,"constructor",{value:_,configurable:!0}),s(_,"constructor",{value:w,configurable:!0}),w.displayName=d(_,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,u,"GeneratorFunction")),e.prototype=Object.create(P),e},t.awrap=function(e){return{__await:e}},R(E.prototype),d(E.prototype,l,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,o,r,i){void 0===i&&(i=Promise);var s=new E(p(e,n,o,r),i);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},R(P),d(P,u,"Generator"),d(P,c,(function(){return this})),d(P,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},t.values=T,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(q),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(o,r){return a.type="throw",a.arg=t,n.next=o,r&&(n.method="next",n.arg=e),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),q(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;q(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={iterator:T(t),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=e),v}},t}function s(e,t,n,o,r,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){s(i,o,r,a,c,"next",e)}function c(e){s(i,o,r,a,c,"throw",e)}a(void 0)}))}}function c(e,t,n){return l.apply(this,arguments)}function l(){return(l=a(i().mark((function e(t,o,r){var s,a,c,l,d,p,f,y,h,m,g,v,b,w,_,x,S,O,P,R;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=(s="\nName: the name of some person.\nBirthday: the birthday of some person.\nAge: number of years lived.\nGender: male or female or other.\nEthnicity / Race: ethnic background. \nNationality: country of citizenship.\nPlace of origin: hometown or birthplace.\nMarital status: single, married, etc.\nFamily relationships: relatives and their connections.\nAddress: residential location.\nPhone number: contact telephone number.\nEmail address: electronic mail address.\nHobbies and interests: personal interests and activities.\nIdentification card: national ID number.\nPassport: passport number.\nDriver's license: license to drive.\nWork permit: employment authorization.\nUser account: account username.\nUser ID: unique user identifier.\nInstant messaging account: IM service handle.\nSocial media account: social network handle.\nNickname: informal name or alias.\nIP address: internet protocol address.\nWeight: body mass.\nHeight: stature.\nBlood type: blood group classification.\nMedical conditions: health status and issues.\nMedical instructions: doctor's orders.\nTest reports: medical test results.\nPhysical examination reports: health checkup results.\nMedical history: past health issues.\nEducational background: level of education completes.\nDegree: academic degree.\nEducational experience: schooling history.\nTranscript: academic record.\nOccupation: job title.\nJob title: specific position at work.\nEmployer: place of employment.\nWork location: place of work.\nWork experience: employment history.\nSalary: earnings from employment.\nResume: professional CV.\nBank card number: debit/credit card number.\nPayment account: online payment account.\nAccount balance: available funds.\nTransaction order: purchase or sale record.\nTransaction amount: value of transactions.\nPayment records: history of payments.\nIncome status: financial earnings.\nProperty information: real estate details.\nDeposit information: savings details.\nVehicle information: car ownership details.\nTax amount: taxes paid.\nVirtual property: digital assets.\nLoan information: borrowing details.\nRepayment information: loan repayment status.\nDebt information: outstanding debts.\nCredit records: credit history.\nCredit information: credit score and details.\nAccount login password: password for account access.\nBank card password: PIN for bank card.\nPayment password: password for transactions.\nAccount query password: password for account \nTransaction password: password for confirming transactions.\nBank card verification code: CVV for security code.\nUSB key: security token device.\nDynamic password: one-time password.\nSMS verification code: code sent via SMS for verification.\nPersonal digital certificate: digital ID for security.\nRandom token: security token for access.\nCommunication records: logs of communications.\nSMS: text messages.\nEmail: electronic mail messages.\nInstant messaging: online chat records.\nContacts: address book entries.\nFriends list: list of social connections.\nGroup list: list of group memberships.\nEmail address list: collection of email contacts.\nFamily relationships: relatives and their connections.\nWork Relationships: colleague connections.\nSocial Relationships: friends and acquaintances.\nWeb Browsing History: record of internet sites visited.\nSoftware Usage Records: application usage data.\nCookies: web browsing data files.\nPublished Social Information: posted social media content.\nSearch History: record of internet searches.\nDownload History: record of downloaded files.\nRegion Code: geographical area code.\nCity Code: code for city identification.\nLongitude and Latitude: geographic coordinates.\nAccommodation Information: housing details.\nCommunity Code: neighborhood identifier.\nStep Count: number of steps taken.\nStep Frequency: steps per minute.\nExercise Duration: length of workout.\nExercise Distance: distance covered in exercise.\nExercise Type: type of physical activity.\nHeart Rate during Exercise: beats per minute during exercise.\nSexual Orientation: sexual preference.\nMarriage History: past marital status.\nReligious Belief: faith or religion.\nUndisclosed Criminal Records: hidden criminal history.\nCommon Languages: languages spoken.\nPast or Current Educational Majors: field of study.\n").split("\n").map((function(e){return e.split(": ")[0]})),c=0;c<a.length;c++)a[c]=a[c].toLowerCase();return l=[[4,.43],[3.69,.43],[3.73,2.29],[3.27,2.57],[2.54,1.14],[2.81,2.86],[3.62,.43],[3.62,1.71],[4.54,1.14],[5.92,0],[5.54,.43],[4.54,0],[3.69,2.14],[6.23,0],[6,0],[5.5,0],[5.65,0],[4.54,.29],[4.46,.14],[5.15,.29],[5.19,.14],[3.08,.86],[5.19,1.14],[3.46,.43],[3.46,.29],[3.54,.14],[5.15,1.14],[5.23,1.14],[5.38,1.57],[5.38,1.14],[5.15,1],[4.15,2.86],[4.15,2.43],[4.65,3.43],[4.04,.71],[4.58,4.29],[4.42,3.29],[5.35,1.14],[5.35,1],[4.96,2.71],[4.85,.43],[5.04,3],[6.04,.14],[6.04,.14],[5.96,0],[5.62,.57],[5.12,.43],[5.38,.43],[5.69,.71],[6.04,.57],[6.12,.43],[5.38,.43],[5.04,.43],[4.77,.57],[5.77,.29],[5.65,.29],[5.85,.29],[5.77,.29],[5.85,.29],[6.15,.57],[6.38,0],[6.35,0],[6.35,0],[6.35,0],[6,0],[5.85,0],[5.62,0],[5.42,.43],[5.15,.57],[4.88,0],[5.5,.71],[5.46,.71],[5.35,1],[5.27,.29],[5.58,.29],[5.31,.29],[4.85,.29],[4.85,.29],[5.73,.71],[5.27,.57],[5.31,.71],[5.77,.86],[5.62,1.14],[4.88,1],[4.54,1.71],[5.35,1.57],[5.31,1.57],[3.96,.57],[3.88,.43],[4.42,.29],[5.58,.14],[4.96,0],[3.38,.14],[3,.14],[3,.57],[2.92,.71],[2.92,.86],[3.12,.29],[3.92,.86],[4.08,1],[3.42,1.86],[5.15,1.29],[2.58,4.29],[3.15,3.43]],d="Please act as an expert adn analyze the private information in the below paragraph. I'll give you an example first. The information class MUST be selected from the given list.\n\n    [Information Classes]\n    "+s,p=n(954),f=p.OpenAIClient,y=p.AzureKeyCredential,h=new f("https://".concat("shuningz",".openai.azure.com/"),new y("02427719893b42868f349a4668288963")),m=[{role:"user",content:"".concat(d).concat("[Example]\n[Example input]\nJohn Doe, born on January 1, 1980, is a 44-year-old Caucasian male from New York, USA. He holds American nationality and currently resides at 1234 Elm Street, Springfield, IL, 62704. John is married to Jane Doe, and they have two children, Alice and Bob Doe. He enjoys reading, hiking, and photography in his free time.\n\nJohn's contact information includes a phone number, (123) 456-7890, and an email address, john.doe@example.com. His identification details include a national ID (123456789), a passport (A12345678), a driver's license (D1234567), and a work permit (WP123456). For online activities, he uses the user account johndoe_80 with user ID 001234567, and his instant messaging and social media accounts are johndoeIM and @johndoe, respectively. He is often referred to by his nickname, Johnny, and his IP address is 192.168.1.1.\n\nPhysically, John is 6 feet tall, weighs 180 pounds, and has an O+ blood type. He has a medical history of asthma and currently manages hypertension with daily medication. His latest medical reports, including blood test and physical examination, indicate good health.\n\nJohn holds a Bachelor's degree in Computer Science from the University of Illinois, where he studied from 1998 to 2002. Professionally, he is a Senior Developer at Tech Solutions Inc., located at 5678 Oak Street, Springfield, IL, 62704, and has 20 years of experience in software development, earning an annual salary of $120,000. His resume and academic transcript are available upon request.\n\nFinancially, John manages a bank card (1234 5678 9012 3456) and an online payment account (johndoe_pay@example.com) with a current balance of $5,000. He has conducted transactions such as a $200 order and a $50 payment to Amazon. He owns a house at 1234 Elm Street, a 2018 Toyota Camry, and has a savings account with $10,000. His annual tax payment is $12,000, and he holds virtual assets, including 5 Bitcoin. John has a mortgage of $200,000, with a monthly repayment of $1,500, and a credit card debt of $2,000, but maintains an excellent credit score of 750.\n\nFor security, John uses various passwords, a USB key, dynamic passwords, SMS verification codes, a personal digital certificate, and a random token for account access and transactions. His communication records, including SMS, email, instant messaging, and contacts, are archived. He has 150 friends on social media, is a member of 10 online groups, and maintains an email address list for personal and professional use.\n\nJohn's browsing history, software usage records, cookies, published social information, search history, and download history are recorded. His geographic information includes a region code (123), city code (456), and coordinates (39.7817° N, 89.6501° W). He has accommodation details for travel, a community code (789), and tracks his physical activity, averaging 10,000 steps daily at a frequency of 100 steps per minute, with 30 minutes of exercise covering 3 miles. His heart rate during exercise is typically 140 BPM.\n\nJohn identifies as heterosexual, has been married since 2005, and practices Christianity. He has no undisclosed criminal records and is fluent in English and Spanish. His academic focus has always been in Computer Science.\n\n[Example output]\n(John Doe)[Name], born on (January 1, 1980)[Date of Birth], is a (44-year-old)[Age] (Caucasian)[Ethnicity] (male)[Gender] from (New York, USA)[Place of Origin]. He holds (American nationality)[Nationality] and currently resides at (1234 Elm Street, Springfield, IL, 62704)[Address]. John is (married)[Marital Status] to Jane Doe, and they have two children, (Alice and Bob Doe)[Family Relationships]. He enjoys (reading, hiking, and photography)[Hobbies and Interests] in his free time.\n\nJohn's contact information includes a phone number, ((123) 456-7890)[Phone Number], and an email address, (john.doe@example.com)[Email Address]. His identification details include a national ID ((123456789))[Identification Card], a passport ((A12345678))[Passport], a driver's license ((D1234567))[Driver's License], and a work permit ((WP123456))[Work Permit]. For online activities, he uses the user account (johndoe_80)[User Account] with user ID (001234567)[User ID], and his instant messaging and social media accounts are (johndoeIM)[Instant Messaging Account] and (@johndoe)[Social Media Account], respectively. He is often referred to by his nickname, (Johnny)[Nickname], and his IP address is (192.168.1.1)[IP Address].\n\nPhysically, John is (6 feet tall)[Height], weighs (180 pounds)[Weight], and has an (O+ blood type)[Blood Type]. He has a medical history of (asthma)[Medical History] and currently manages (hypertension)[Medical Conditions] with daily medication (Medical Instructions). His latest medical reports, including (blood test)[Test Reports] and (physical examination)[Physical Examination Reports], indicate good health.\n\nJohn holds a (Bachelor's degree)[Degree] in (Computer Science)[Past or Current Educational Majors] from (University of Illinois)[Educational Experience], where he studied from 1998 to 2002. Professionally, he is a (Senior Developer)[Job Title] at (Tech Solutions Inc.)[Employer], located at (5678 Oak Street, Springfield, IL, 62704)[Work Location], and has (20 years)[Work Experience] of experience in software development, earning an annual salary of ($120,000)[Salary]. His (resume)[Resume] and academic (transcript)[Transcript] are available upon request.\n\nFinancially, John manages a bank card ((1234 5678 9012 3456))[Bank Card Number] and an online payment account ((johndoe_pay@example.com))[Payment Account] with a current balance of ($5,000)[Account Balance]. He has conducted transactions such as a ($200 order)[Transaction Order] and a ($50 payment to Amazon)[Payment Records]. He owns a house at (1234 Elm Street)[Property Information], a (2018 Toyota Camry)[Vehicle Information], and has a savings account with ($10,000)[Deposit Information]. His annual tax payment is ($12,000)[Tax Amount], and he holds virtual assets, including (5 Bitcoin)[Virtual Property]. John has a mortgage of ($200,000)[Loan Information], with a monthly repayment of ($1,500)[Repayment Information], and a credit card debt of ($2,000)[Debt Information], but maintains an excellent credit score of (750)[Credit Information].\n\nFor security, John uses various passwords ([Account Login Password], [Bank Card Password], [Payment Password], [Account Query Password], [Transaction Password]), a (USB key)[USB Key], dynamic passwords ([Dynamic Password]), SMS verification codes ([SMS Verification Code]), a (personal digital certificate)[Personal Digital Certificate], and a (random token)[Random Token] for account access and transactions. His (communication records)[Communication Records], including (SMS)[SMS], (email)[Email], (instant messaging)[Instant Messaging], and (contacts)[Contacts], are archived. He has (150 friends)[Friends List] on social media, is a member of (10 online groups)[Group List], and maintains an (email address list)[Email Address List] for personal and professional use.\n\nJohn's (browsing history)[Web Browsing History], (software usage records)[Software Usage Records], (cookies)[Cookies], (published social information)[Published Social Information], (search history)[Search History], and (download history)[Download History] are recorded. His geographic information includes a (region code (123))[Region Code], (city code (456))[City Code], and (coordinates (39.7817° N, 89.6501° W))[Longitude and Latitude]. He has (accommodation details)[Accommodation Information] for travel, a (community code (789))[Community Code], and tracks his physical activity, averaging (10,000 steps)[Step Count] daily at a frequency of (100 steps per minute)[Step Frequency], with (30 minutes of exercise covering 3 miles)[Exercise Distance]. His heart rate during exercise is typically (140 BPM)[Heart Rate during Exercise].\n\nJohn identifies as (heterosexual)[Sexual Orientation], has been (married since 2005)[Marriage History], and practices (Christianity)[Religious Belief]. He has no (undisclosed criminal records)[Undisclosed Criminal Records] and is fluent in (English and Spanish)[Common Languages]. His academic focus has always been in (Computer Science)[Past or Current Educational Majors].\n\n[Real Input]\n").concat(r)}],e.prev=12,e.next=15,h.getChatCompletions("gpt-4o",m);case 15:if((b=e.sent).choices&&0!==b.choices.length){e.next=18;break}throw new Error("No completion returned");case 18:for(console.log("Chatbot: ".concat(null===(g=b.choices[0].message)||void 0===g?void 0:g.content)),w=null===(v=b.choices[0].message)||void 0===v?void 0:v.content,_=/\((.*?)\)\[(.*?)\]/g,S=[];null!==(x=_.exec(w));)O=x[1],P=x[2],O&&P?S.push({value:O,type:P}):console.warn("Skipping invalid match: ".concat(x[0]));return R=u(r,S,a,l,t,o),console.log("Pseudonymized text:",R),console.log(r),console.log(S),e.abrupt("return",R);case 30:throw e.prev=30,e.t0=e.catch(12),console.error(e.t0),e.t0;case 34:case"end":return e.stop()}}),e,null,[[12,30]])})))).apply(this,arguments)}function u(e,t,n,o,i,s){return t.forEach((function(t){var a,c,l=t.type.toLowerCase();if(n.includes(l)){var u=n.indexOf(l),d=(a=o[u],c=2,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,s,a=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=i.call(n)).done)&&(a.push(o.value),a.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(a,c)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(a,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=d[0],f=d[1];if(console.log(p,f),100*p>7*i&&100*f<7*s){var y="[".concat(t.type,"]");e=e.replace(new RegExp(t.value,"g"),y)}}})),e}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},chrome.runtime.onMessage.addListener((function(e,t,n){"showFloatingBox"===e.action&&(console.log("script mode:",e.mode),function(e,t,n){var o=document.querySelector(".floatingBox");o&&o.remove();var r=window.getSelection().getRangeAt(0).cloneRange().getBoundingClientRect(),s=document.createElement("div");s.classList.add("floatingBox"),s.style.position="absolute",s.style.top="".concat(r.top+window.scrollY,"px"),s.style.left="".concat(r.left+window.scrollX,"px"),s.style.width="300px",s.style.padding="10px",s.style.backgroundColor="white",s.style.border="1px solid #ccc",s.style.boxShadow="0 0 10px rgba(0,0,0,0.5)",s.style.zIndex="10000",s.style.borderRadius="10px",s.style.color="black",console.log("mode:",t);var l="",u="";if("Privacy & Utility"==t){s.innerHTML='\n\t\t\t<div>\n\t\t\t\t<button id="closeButton" style="position: absolute; top: 5px; right: 5px; background-color: transparent; border: none; color: #333; font-size: 16px;">&times;</button>\n\t\t\t\t<label for="quadrantController" style="margin-top: 10px;">选择匿名性和可用性指标:</label>\n\t\t\t\t<div style="position: relative; width: 240px; height: 260px; margin-top: 10px;">\n\t\t\t\t\t<canvas id="quadrantController" width="200" height="200" style="background-color: #f0f0f0; position: absolute; left: 30px; top: 20px"></canvas>\n\t\t\t\t\t<div style="position: absolute; left: 50%; transform: translateX(-50%);">Privacy</div>\n\t\t\t\t\t<div style="position: absolute; top: 50%; transform: translateY(-50%) rotate(-90deg);">Utility</div>\n\t\t\t\t\t<div id="coordinates" style="position: absolute; top: 90%; left: 50%; transform: translateX(-50%); color: black; text-align: center; width: 100%;"></div>\n\t\t\t\t</div>\n\t\t\t\t<button id="confirmButton" style="margin-top: 10px; width: 100%;">Confirm</button>\n\t\t\t\t<div id="statusBox" style="margin-top: 10px;"></div>\n\t\t\t\t<textarea id="resultBox" style="margin-top: 10px; max-height: 180px; overflow-y: auto; white-space: pre-wrap; width: 100%; height: 150px; display: none"></textarea>\n\t\t\t\t<button id="copyButton" style="margin-top: 10px; width: 100%; display: none">Copy</button>\n\t\t\t\t<div id="copyMessage" style="margin-top: 10px; display: none; color: green; left: 40%">已复制到剪贴板</div>\n\t\t\t</div>\n\t\t',document.body.appendChild(s);var d=document.getElementById("quadrantController"),p=d.getContext("2d"),f=d.width,y=d.height;p.beginPath(),p.moveTo(0,y),p.arc(0,y,f,1.5*Math.PI,2*Math.PI),p.lineTo(0,y),p.closePath(),p.fillStyle="#ddd",p.fill();var h={x:50,y:50};d.addEventListener("click",(function(e){var t=d.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top,r=n-0,i=o-y;Math.sqrt(r*r+i*i)<=f&&n>=0&&o<=y&&(h.x=(n-0)/f*100,h.y=100*(1-o/f),function(e,t){p.clearRect(0,0,d.width,d.height),p.beginPath(),p.moveTo(0,y),p.arc(0,y,f,1.5*Math.PI,2*Math.PI),p.lineTo(0,y),p.closePath(),p.fillStyle="#ddd",p.fill(),p.beginPath(),p.arc(e,t,5,0,2*Math.PI),p.fillStyle="#000",p.fill(),document.getElementById("coordinates").textContent="Privacy: ".concat(h.x.toFixed(2),"%, Utility: ").concat(h.y.toFixed(2),"%")}(n,o))})),s.querySelector("#closeButton").addEventListener("click",(function(){s.remove(),chrome.runtime.sendMessage({type:"AddLog",raw:e,processed:l,last:u,origin:n.origin})})),s.querySelector("#confirmButton").addEventListener("click",a(i().mark((function t(){var n,o,r,s,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,o=h.x,r=h.y,(s=document.querySelector("#statusBox")).textContent="处理中...",t.prev=5,t.next=8,c(o,r,n);case 8:l=t.sent,s.textContent="处理成功",(a=document.querySelector("#resultBox")).value=l,a.style.display="block",document.querySelector("#copyButton").style.display="block",t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),console.error(t.t0),s.textContent="处理失败";case 21:case"end":return t.stop()}}),t,null,[[5,17]])})))),s.querySelector("#copyButton").addEventListener("click",(function(){var e=document.querySelector("#resultBox");u=e.value,navigator.clipboard?navigator.clipboard.writeText(e.value).then((function(){console.log("文本已复制到剪贴板");var e=document.querySelector("#copyMessage");e.style.display="block",setTimeout((function(){e.style.display="none"}),2e3)})).catch((function(e){console.error("复制文本失败:",e)})):console.log("浏览器不支持剪贴板API")}))}else"Automatic"==t?(s.innerHTML='\n\t\t\t<div>\n\t\t\t\t<button id="closeButton" style="position: absolute; top: 5px; right: 5px; background-color: transparent; border: none; color: #333; font-size: 16px;">&times;</button>\n\t\t\t\t<button id="confirmButton" style="margin-top: 10px; width: 100%;">Confirm</button>\n\t\t\t\t<div id="statusBox" style="margin-top: 10px;"></div>\n\t\t\t\t<textarea id="resultBox" style="margin-top: 10px; max-height: 180px; overflow-y: auto; white-space: pre-wrap; width: 100%; height: 150px; display: none"></textarea>\n\t\t\t\t<button id="copyButton" style="margin-top: 10px; width: 100%; display: none">Copy</button>\n\t\t\t\t<div id="copyMessage" style="margin-top: 10px; display: none; color: green; left: 40%">已复制到剪贴板</div>\n\t\t\t</div>\n\t\t',document.body.appendChild(s),s.querySelector("#closeButton").addEventListener("click",(function(){s.remove(),chrome.runtime.sendMessage({type:"AddLog",raw:e,processed:l,last:u,origin:n.origin})})),s.querySelector("#confirmButton").addEventListener("click",a(i().mark((function t(){var n,o,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,(o=document.querySelector("#statusBox")).textContent="处理中...",t.prev=3,t.next=6,c(0,100,n);case 6:l=t.sent,o.textContent="处理成功",(r=document.querySelector("#resultBox")).value=l,r.style.display="block",document.querySelector("#copyButton").style.display="block",t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),console.error(t.t0),o.textContent="处理失败";case 19:case"end":return t.stop()}}),t,null,[[3,15]])})))),s.querySelector("#copyButton").addEventListener("click",(function(){var e=document.querySelector("#resultBox");u=e.value,navigator.clipboard?navigator.clipboard.writeText(e.value).then((function(){console.log("文本已复制到剪贴板");var e=document.querySelector("#copyMessage");e.style.display="block",setTimeout((function(){e.style.display="none"}),2e3)})).catch((function(e){console.error("复制文本失败:",e)})):console.log("浏览器不支持剪贴板API")}))):"Privacy Only"==t?(s.innerHTML='\n\t\t\t<div>\n\t\t\t\t<button id="closeButton" style="position: absolute; top: 5px; right: 5px; background-color: transparent; border: none; color: #333; font-size: 16px;">&times;</button>\n\t\t\t\t<label for="progress1">Privacy:</label>\n        \t\t<input type="range" id="progress1" value="50" max="100" style="width: 100%;">\n\t\t\t\t<button id="confirmButton" style="margin-top: 10px; width: 100%;">Confirm</button>\n\t\t\t\t<div id="statusBox" style="margin-top: 10px;"></div>\n\t\t\t\t<textarea id="resultBox" style="margin-top: 10px; max-height: 180px; overflow-y: auto; white-space: pre-wrap; width: 100%; height: 150px; display: none"></textarea>\n\t\t\t\t<button id="copyButton" style="margin-top: 10px; width: 100%; display: none">Copy</button>\n\t\t\t\t<div id="copyMessage" style="margin-top: 10px; display: none; color: green; left: 40%">已复制到剪贴板</div>\n\t\t\t</div>\n\t\t',document.body.appendChild(s),s.querySelector("#closeButton").addEventListener("click",(function(){s.remove(),chrome.runtime.sendMessage({type:"AddLog",raw:e,processed:l,last:u,origin:n.origin})})),s.querySelector("#confirmButton").addEventListener("click",a(i().mark((function t(){var n,o,r,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,o=document.querySelector("#progress1").value,(r=document.querySelector("#statusBox")).textContent="处理中...",t.prev=4,t.next=7,c(o,100,n);case 7:l=t.sent,r.textContent="处理成功",(s=document.querySelector("#resultBox")).value=l,s.style.display="block",document.querySelector("#copyButton").style.display="block",t.next=20;break;case 16:t.prev=16,t.t0=t.catch(4),console.error(t.t0),r.textContent="处理失败";case 20:case"end":return t.stop()}}),t,null,[[4,16]])})))),s.querySelector("#copyButton").addEventListener("click",(function(){var e=document.querySelector("#resultBox");u=e.value,navigator.clipboard?navigator.clipboard.writeText(e.value).then((function(){console.log("文本已复制到剪贴板");var e=document.querySelector("#copyMessage");e.style.display="block",setTimeout((function(){e.style.display="none"}),2e3)})).catch((function(e){console.error("复制文本失败:",e)})):console.log("浏览器不支持剪贴板API")}))):"Utility Only"==t?(s.innerHTML='\n\t\t\t<div>\n\t\t\t\t<button id="closeButton" style="position: absolute; top: 5px; right: 5px; background-color: transparent; border: none; color: #333; font-size: 16px;">&times;</button>\n\t\t\t\t<label for="progress2">Utility:</label>\n        \t\t<input type="range" id="progress2" value="50" max="100" style="width: 100%;">\n\t\t\t\t<button id="confirmButton" style="margin-top: 10px; width: 100%;">Confirm</button>\n\t\t\t\t<div id="statusBox" style="margin-top: 10px;"></div>\n\t\t\t\t<textarea id="resultBox" style="margin-top: 10px; max-height: 180px; overflow-y: auto; white-space: pre-wrap; width: 100%; height: 150px; display: none"></textarea>\n\t\t\t\t<button id="copyButton" style="margin-top: 10px; width: 100%; display: none">Copy</button>\n\t\t\t\t<div id="copyMessage" style="margin-top: 10px; display: none; color: green; left: 40%">已复制到剪贴板</div>\n\t\t\t</div>\n\t\t',document.body.appendChild(s),s.querySelector("#closeButton").addEventListener("click",(function(){s.remove(),chrome.runtime.sendMessage({type:"AddLog",raw:e,processed:l,last:u,origin:n.origin})})),s.querySelector("#confirmButton").addEventListener("click",a(i().mark((function t(){var n,o,r,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,o=document.querySelector("#progress2").value,(r=document.querySelector("#statusBox")).textContent="处理中...",t.prev=4,t.next=7,c(0,o,n);case 7:l=t.sent,r.textContent="处理成功",(s=document.querySelector("#resultBox")).value=l,s.style.display="block",document.querySelector("#copyButton").style.display="block",t.next=20;break;case 16:t.prev=16,t.t0=t.catch(4),console.error(t.t0),r.textContent="处理失败";case 20:case"end":return t.stop()}}),t,null,[[4,16]])})))),s.querySelector("#copyButton").addEventListener("click",(function(){var e=document.querySelector("#resultBox");u=e.value,navigator.clipboard?navigator.clipboard.writeText(e.value).then((function(){console.log("文本已复制到剪贴板");var e=document.querySelector("#copyMessage");e.style.display="block",setTimeout((function(){e.style.display="none"}),2e3)})).catch((function(e){console.error("复制文本失败:",e)})):console.log("浏览器不支持剪贴板API")}))):"None"==t?(s.innerHTML='\n\t\t\t<div>\n\t\t\t\t<button id="closeButton" style="position: absolute; top: 5px; right: 5px; background-color: transparent; border: none; color: #333; font-size: 16px;">&times;</button>\n\t\t\t\t<textarea id="resultBox" style="margin-top: 10px; max-height: 180px; overflow-y: auto; white-space: pre-wrap; width: 100%; height: 150px;"></textarea>\n\t\t\t\t<button id="copyButton" style="margin-top: 10px; width: 100%;">Copy</button>\n\t\t\t\t<div id="copyMessage" style="margin-top: 10px; display: none; color: green; left: 40%">已复制到剪贴板</div>\n\t\t\t</div>\n\t\t',document.body.appendChild(s),resultBox.value=e,s.querySelector("#closeButton").addEventListener("click",(function(){s.remove(),chrome.runtime.sendMessage({type:"AddLog",raw:e,processed:l,last:u,origin:n.origin})})),s.querySelector("#copyButton").addEventListener("click",(function(){var e=document.querySelector("#resultBox");u=e.value,navigator.clipboard?navigator.clipboard.writeText(e.value).then((function(){console.log("文本已复制到剪贴板");var e=document.querySelector("#copyMessage");e.style.display="block",setTimeout((function(){e.style.display="none"}),2e3)})).catch((function(e){console.error("复制文本失败:",e)})):console.log("浏览器不支持剪贴板API")}))):"DP Baseline"==t?(s.innerHTML='\n\t\t\t<div>\n\t\t\t\t<button id="closeButton" style="position: absolute; top: 5px; right: 5px; background-color: transparent; border: none; color: #333; font-size: 16px;">&times;</button>\n\t\t\t\t<textarea id="contentBox" style="margin-top: 10px; max-height: 180px; overflow-y: auto; white-space: pre-wrap; width: 100%; height: 150px;"></textarea>\n\t\t\t\t<button id="confirmButton" style="margin-top: 10px; width: 100%;">Confirm</button>\n\t\t\t\t<div id="statusBox" style="margin-top: 10px;"></div>\n\t\t\t\t<textarea id="resultBox" style="margin-top: 10px; max-height: 180px; overflow-y: auto; white-space: pre-wrap; width: 100%; height: 150px; display: none"></textarea>\n\t\t\t\t<button id="copyButton" style="margin-top: 10px; width: 100%; display: none">Copy</button>\n\t\t\t\t<div id="copyMessage" style="margin-top: 10px; display: none; color: green; left: 40%">已复制到剪贴板</div>\n\t\t\t</div>\n\t\t',document.body.appendChild(s),contentBox.value=e,s.querySelector("#closeButton").addEventListener("click",(function(){s.remove(),chrome.runtime.sendMessage({type:"AddLog",raw:e,processed:l,last:u,origin:n.origin})})),s.querySelector("#confirmButton").addEventListener("click",a(i().mark((function t(){var o,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(o=document.querySelector("#statusBox")).textContent="处理中...",r=n.origin,chrome.runtime.sendMessage({type:"fetchData",data:e,origin:r},(function(e){if(e.success){l=e.data.anonymized_text,o.textContent="处理成功";var t=document.querySelector("#resultBox");t.value=l,t.style.display="block",document.querySelector("#copyButton").style.display="block"}else console.error("Error fetching data:",e.error),o.textContent="处理失败"}));case 5:case"end":return t.stop()}}),t)})))),s.querySelector("#copyButton").addEventListener("click",(function(){var e=document.querySelector("#resultBox");u=e.value,navigator.clipboard?navigator.clipboard.writeText(e.value).then((function(){console.log("文本已复制到剪贴板");var e=document.querySelector("#copyMessage");e.style.display="block",setTimeout((function(){e.style.display="none"}),2e3)})).catch((function(e){console.error("复制文本失败:",e)})):console.log("浏览器不支持剪贴板API")}))):console.log("Mode error!")}(e.selectedText,e.mode,e.tabUrl),n({status:"success"}))}))})();