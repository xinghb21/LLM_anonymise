(()=>{"use strict";chrome.runtime.onInstalled.addListener((function(){console.log("Privacy Control with OpenAI extension installed."),chrome.contextMenus.create({id:"anonymize-text",title:"Anonymize text",contexts:["selection"]})})),chrome.runtime.onMessage.addListener((function(e,o,t){e.mode&&(console.log("Received mode:",e.mode),chrome.storage.sync.set({selectMode:e.mode},(function(){console.log("Mode is stored in chrome.storage:",e.mode)}))),t({status:"Mode received"})})),chrome.contextMenus.onClicked.addListener((function(e,o){if("anonymize-text"===e.menuItemId){var t=e.selectionText||" ";console.log("Executing script with selected text:",t),n=function(e){chrome.scripting.executeScript({target:{tabId:e},files:["dist/script.bundle.js"]}).then((function(){console.log("Injected script file"),chrome.storage.sync.get(["selectMode"],(function(e){console.log("mode:",e.selectMode),chrome.runtime.lastError?console.error("Error retrieving mode:",chrome.runtime.lastError):(console.log("Injected script file"),chrome.tabs.sendMessage(o.id,{action:"showFloatingBox",selectedText:t,mode:e.selectMode||"None"}))}))})).catch((function(e){console.error("Failed to inject script:",e)}))},chrome.tabs.query({active:!0,currentWindow:!0},(function(e){n(e[0].id)}))}var n}))})();