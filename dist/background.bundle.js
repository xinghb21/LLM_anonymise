(()=>{var e="None";chrome.runtime.onInstalled.addListener((function(){console.log("Privacy Control with OpenAI extension installed."),chrome.contextMenus.create({id:"anonymize-text",title:"Anonymize text",contexts:["selection"]})})),chrome.runtime.onMessage.addListener((function(t,n,o){t.mode&&(console.log("Received mode:",t.mode),e=t.mode,o({status:"Mode received"}))}));var t={};function n(t,n,o){chrome.tabs.sendMessage(t,{action:"showFloatingBox",selectedText:n,mode:e,tabUrl:o},(function(e){chrome.runtime.lastError?console.error("Error sending message:",chrome.runtime.lastError.message):console.log("Response from content script:",e)}))}chrome.contextMenus.onClicked.addListener((function(e,o){if("anonymize-text"===e.menuItemId){var r=e.selectionText||" ";console.log("Executing script with selected text:",r),c=function(e){var c=o.url;t.hasOwnProperty(e)||!t[e]?chrome.scripting.executeScript({target:{tabId:e},files:["dist/script.bundle.js"]}).then((function(){console.log("Injected script file"),t[e]=!0,n(o.id,r,c)})).catch((function(e){console.error("Failed to inject script:",e)})):n(o.id,r,c)},chrome.tabs.query({active:!0,currentWindow:!0},(function(e){c(e[0].id)}))}var c})),chrome.runtime.onInstalled.addListener((function(){console.log("Extension installed")})),chrome.runtime.onMessage.addListener((function(e,t,n){if("fetchData"===e.type){var o=new URLSearchParams({data:e.data});return fetch("".concat("http://43.153.182.221:5001/anonymize","?").concat(o.toString()),{method:"GET",headers:{Origin:e.origin}}).then((function(e){return e.json()})).then((function(e){n({success:!0,data:e})})).catch((function(e){console.error("Error:",e),n({success:!1,error:e})})),!0}if("AddLog"===e.type){console.log("Received log:",e);var r={raw:e.raw,processed:e.processed,last:e.last};fetch("http://43.153.182.221:5001/write_to_file",{method:"POST",headers:{"Content-Type":"application/json",Origin:e.origin},body:JSON.stringify(r)}).then((function(e){return e.json()})).then((function(e){console.log("Success:",e)})).catch((function(e){console.error("Error:",e)}))}}))})();