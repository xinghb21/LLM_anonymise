(()=>{"use strict";var e="None";chrome.runtime.onInstalled.addListener((function(){console.log("Privacy Control with OpenAI extension installed."),chrome.contextMenus.create({id:"anonymize-text",title:"Anonymize text",contexts:["selection"]})})),chrome.runtime.onMessage.addListener((function(t,n,o){t.mode&&(console.log("Received mode:",t.mode),e=t.mode,o({status:"Mode received"}))}));var t=!1;function n(t,n,o){console.log("mode:",e),chrome.tabs.sendMessage(t,{action:"showFloatingBox",selectedText:n,mode:e,tabUrl:o})}chrome.contextMenus.onClicked.addListener((function(e,o){if("anonymize-text"===e.menuItemId){var c=e.selectionText||" ";console.log("Executing script with selected text:",c),i=function(e){var i=o.url;t?n(o.id,c,i):chrome.scripting.executeScript({target:{tabId:e},files:["dist/script.bundle.js"]}).then((function(){console.log("Injected script file"),t=!0,n(o.id,c,i)})).catch((function(e){console.error("Failed to inject script:",e)}))},chrome.tabs.query({active:!0,currentWindow:!0},(function(e){i(e[0].id)}))}var i})),chrome.runtime.onInstalled.addListener((function(){console.log("Extension installed")})),chrome.runtime.onMessage.addListener((function(e,t,n){if("fetchData"===e.type){var o=new URLSearchParams({data:e.data});return fetch("".concat("http://43.153.182.221:5001/anonymize","?").concat(o.toString()),{method:"GET",headers:{Origin:e.origin}}).then((function(e){return e.json()})).then((function(e){n({success:!0,data:e})})).catch((function(e){console.error("Error:",e),n({success:!1,error:e})})),!0}}))})();